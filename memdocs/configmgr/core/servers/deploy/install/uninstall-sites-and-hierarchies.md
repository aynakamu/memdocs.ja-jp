---
title: サイトのアンインストール
titleSuffix: Configuration Manager
description: 役割を削除し、サイトと階層をアンインストールするためのガイド
ms.date: 04/01/2020
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: d466edd2-97f0-44c1-a73e-d71abbdbf4a8
author: mestew
ms.author: mstewart
manager: dougeby
ms.openlocfilehash: a90d6f34370b8c3167272bce1a0a673cc5074094
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/21/2020
ms.locfileid: "81700530"
---
# <a name="uninstall-roles-sites-and-hierarchies-in-configuration-manager"></a>Configuration Manager での役割、サイト、および階層のアンインストール

*適用対象:Configuration Manager (Current Branch)*

この記事は、Configuration Manager サイト システムの役割、サイト、または階層をアンインストールするためのガイドとして使用します。

バージョン 2002 以降では、階層から中央管理サイト (CAS) を削除しても、プライマリ サイトを保持することもできます。

## <a name="site-system-role"></a><a name="bkmk_role"></a> サイト システムの役割

以下の理由があれば、サイト システム サーバーから役割を削除することが推奨されます。

- ネットワークや物理的な場所など、より広範なインフラストラクチャの変更
- 基になるサーバーの使用停止
- コストと複雑さの軽減のための役割の統合
- サイトの役割の再構成または再設計
- 役割でサポートしている機能の使用中止

役割を削除する必要があると判断したら、まず、以下の質問に対する回答をよく考えてください。

- サイトでまだその役割が必要ですか。 その場合、別のサイト システムにその役割が既にありますか。

- この役割を持つ他のサイト システムは、パフォーマンスと可用性のビジネス要件をサポートするうえで適切なサイズになっていますか。

- すべてのクライアントが、別の役割を使用するように既に再構成されていますか。 フォールバックや別のサーバーの検出を行う既定のクライアント動作が必要となりますか。

### <a name="procedure-to-remove-a-site-system-role"></a>サイト システムの役割を削除する手順

次の手順に従って役割を削除します。

1. **Configuration Manager** コンソールで、 **[管理]** ワークスペースに移動します。 **[サイトの構成]** を展開し、 **[サーバーとサイト システムの役割]** ノードを選択します。

1. 削除する役割があるサイト システム サーバーを選択します。 **[サイトシステムの役割]** 詳細ウィンドウで、目的の役割を選択します。

1. リボンの **[サイトの役割]** タブにある **[サイトの役割]** グループで、 **[役割の削除]** を選択します。 役割を削除することを確認します。

### <a name="additional-information-for-specific-roles"></a>特定の役割についての追加情報

一部の役割には、追加の手順や考慮事項がある場合があります。

#### <a name="software-update-point"></a>ソフトウェアの更新ポイント

ソフトウェアの更新ポイントを削除すると、Configuration Manager によってクライアント ポリシーが更新され、一覧からソフトウェアの更新ポイントが削除されます。 サイトにある最後のソフトウェアの更新ポイントを削除すると、ソフトウェアの更新ポイントの一覧には、ソフトウェアの更新ポイントが含まれなくなります。 使用できる役割がないと、サイトでは、ソフトウェア更新プログラムの管理が事実上無効になっています。

プライマリ サイトに複数のソフトウェアの更新ポイントがあり、同期ソースであるソフトウェアの更新ポイントを削除する場合は、新しい同期ソースにする、サイトにある別のソフトウェアの更新ポイントを選択する必要があります。

## <a name="secondary-site"></a><a name="bkmk_secondary"></a> セカンダリ サイト  

[階層の使用を停止する](#bkmk_hierarchy)場合を除き、セカンダリ サイトを削除する主な理由となるのは、ネットワークや物理的な場所など、より広範なインフラストラクチャの変更があることです。 [セカンダリ サイトを選択する](../../../plan-design/hierarchy/design-a-hierarchy-of-sites.md#BKMK_ChooseSecondary)理由も確認してくださいます。

セカンダリ サイトを削除する必要があると判断したら、まず、以下の質問に対する回答をよく考えてください。

- サイト サーバーからすべてのサイト システムの役割を削除しましたか。

- セカンダリ サイトに関連付けられている境界または境界グループがありますか。 サイトを削除する前に境界を再構成してください。

- その場所にクライアントがまだありますか。

- [ピア キャッシュ](../../../plan-design/hierarchy/fundamental-concepts-for-content-management.md#peer-caching-technologies)など、その他のコンテンツ管理オプションを構成しましたか。

### <a name="options-to-delete-secondary-sites"></a>セカンダリ サイトを削除するためのオプション

セカンダリ サイトを別のプライマリ サイトに移動したり再割り当てしたりすることはできません。 セカンダリ サイトを直接の親サイトから削除する場合は、アンインストールするか削除するかを選択します。

#### <a name="uninstall-the-secondary-site"></a>セカンダリ サイトのアンインストール

ネットワークからアクセスできる、機能しているセカンダリ サイトを削除するには、このオプションを使用します。 このオプションでは、セカンダリ サイト サーバーから Configuration Manager がアンインストールされます。 次に、Configuration Manager サイトから、サイトとそのリソースに関するすべての情報が削除されます。

Configuration Manager によってセカンダリ サイトの SQL Server Express がインストールされた場合は、SQL Express も Configuration Manager によってアンインストールされます。 セカンダリ サイトをインストールする前に SQL Server Express をインストールした場合、SQL Server Express は Configuration Manager によってアンインストールされません。

#### <a name="delete-the-secondary-site"></a>セカンダリ サイトの削除

このオプションは、以下のような状況で使用します。

- インストールに失敗した

- アンインストール後、Configuration Manager コンソールにセカンダリ サイトがまだ表示される

    このオプションを使用すると、Configuration Manager 階層からサイトとそのリソースの情報がすべて削除されますが、サイト サイバーに一切変更は加えられません。

    > [!TIP]
    >  **/DELSITE** オプションを指定して階層のメンテナンス ツールを使用し、セカンダリ サイトを削除することもできます。 詳細については、[階層のメンテナンス ツール (Preinst.exe)](../../manage/hierarchy-maintenance-tool-preinst.exe.md) に関するページを参照してください。

### <a name="prerequisites-to-delete-a-secondary-site"></a>セカンダリ サイトを削除するための前提条件

Configuration Manager のセットアップを実行する管理ユーザーには、以下のセキュリティ権限が必要です。

- セカンダリ サイト サーバーでのローカル**管理者**権限

- プライマリ サイトのデータベース サーバーが、プライマリ サイト サーバーから見てリモートにある場合は、プライマリ サイトのリモート サイト データベース サーバーでのローカル**管理者**権限。

- 親プライマリ サイトでの**インフラストラクチャ管理者**または**完全な権限を持つ管理者**のセキュリティ ロール

- セカンダリ サイト データベースでの **sysadmin** 権限

### <a name="procedure-to-delete-a-secondary-site"></a>セカンダリ サイトを削除する手順

セカンダリ サイトをアンインストールまたは削除するには、以下の手順に従います。

1. Configuration Manager コンソールで、 **[管理]** ワークスペースに移動し、 **[サイトの構成]** を展開してから **[サイト]** ノードを選択します。

1. 削除するセカンダリ サイト サーバーを選択します。 リボンの **[ホーム]** タブにある **[サイト]** グループで、 **[削除]** をクリックします。

1. **[全般]** ページで、セカンダリ サイトをアンインストールするか削除するかを選択します。

1.  ウィザードを完了します。

## <a name="primary-site"></a><a name="bkmk_primary"></a> プライマリ サイト  

以下の理由があれば、階層からプライマリ サイトをアンインストールすることが推奨されます。

- コストと複雑さの軽減のためのサイトの統合
- 階層のサイトの再構成または再設計

CAS へのレプリケーション リンクのために[分散ビュー](../../../plan-design/hierarchy/database-replication.md#bkmk_distviews)を使用している子プライマリ サイトをアンインストールする前に、まず、階層で分散ビューを無効にします。 詳細については、「 [分散ビューで構成されたプライマリ サイトのアンインストール](#bkmk_distviews)」をご覧ください。

### <a name="plan-to-uninstall-a-primary-site"></a><a name="bkmk_pri-plan"></a> プライマリ サイトをアンインストールするための計画

プライマリ サイトをアンインストールする前に、以下の作業について確認してください。

- 境界、境界グループ、およびフォールバックの関係を確認します。 クライアントを新しいサイトに割り当てても境界を変更しない場合、クライアントはローミング中と見なされる可能性があります。 詳しくは、「[サイト境界と境界グループの定義](../configure/define-site-boundaries-and-boundary-groups.md)」をご覧ください。

- すべてのアクティブなクライアントが階層内の別のプライマリ サイトに再割り当てされていることを確認します。 そうでないと、サイトのアンインストール後にクライアントが管理されません。 詳細については、「[サイトにクライアントを割り当てる方法](../../../clients/deploy/assign-clients-to-a-site.md)」を参照してください。

  - サイトの役割の一覧を見直して、新しいサイトで同じレベルのサービスが提供されることを確認します。

  - その他のサイトで、この役割を使用して他のサイト システムのサイズを適切に設定したことを確認します。 これらは、クライアントが追加される状況で、パフォーマンスと可用性に関するビジネス要件をサポートする必要があります。

  - このサイトにクライアントが多数ある場合は、それらを段階的に再割り当てします。 クライアントが完全なインベントリおよびその他のサイト固有のデータを最新の情報に更新する際に、データベース レプリケーションを監視します。 ソフトウェア更新プログラムを管理する場合、クライアントは、新しいソフトウェアの更新ポイントに割り当てられます。 この動作によって、更新プログラムのコンプライアンスについてフル スキャンが行われます。

  - クライアントの再割り当ては、インベントリ データと状態ベースのコンプライアンスに依存するレポートやクエリに影響を与える可能性があります。 移行中には、クライアント サイクルを一時的に調整することを検討してください。

  - すべてのクライアントの割り当て方法を確認し、このプライマリ サイトを参照しているクライアントがないようにします。

- 階層内でアクティブに使用されているオブジェクトに、サイト コードへの静的参照があるかどうかを調べます。 コレクション クエリ、タスク シーケンス、管理スクリプトなどです。

- 階層で、自動サイト割り当てのために[フォールバック サイト](../configure/boundary-group-procedures.md#bkmk_site-fallback)を使用している場合は、それがこのプライマリ サイトを参照していないことを確認します。

- 静的なサイトコードを参照する可能性のある[クライアント インストール方法](../../../clients/deploy/plan/client-installation-methods.md)があれば再構成します。

- このプライマリ サイトに、サイト固有のクラウド接続サービスがある場合は、それらを必ず削除します。 クラウド リソースがまだ必要な場合は、階層内の別のプライマリ サイトにリソースを移動します。 アンインストールしようとしているプライマリ サイトからそれらを削除し、別のプライマリ サイトに追加します。

- このプライマリ サイトに階層の[探索方法](../configure/run-discovery.md)が置かれている場合は、それらを別のサイトに移動します。

- サイト ベースの [OS 展開メディア](../../../../osd/deploy-use/create-task-sequence-media.md)をすべて削除します。

- サイトとサイト サーバーから、すべてのサイト システムの役割をアンインストールします。 詳細については、[サイト システムの役割のアンインストール](#bkmk_role)に関するページを参照してください。 この準備手順は必須ではありませんが、サイトのアンインストール前に追加の依存関係を特定するのに役立ちます。

- このプライマリ サイトの下にあるセカンダリ サイトをすべてアンインストールします。 詳細については、「[セカンダリ サイト](#bkmk_secondary)」のセクションを参照してください。

### <a name="prerequisites-to-uninstall-a-primary-site"></a><a name="bkmk_pri-prereq"></a> プライマリ サイトをアンインストールするための前提条件

Configuration Manager のセットアップを実行する管理ユーザーには、以下のセキュリティ権限が必要です。

- CAS サーバーでのローカル**管理者**権限

- CAS データベース サーバーがサイト サーバーからリモートにある場合は、CAS のリモート サイト データベース サーバーのローカル**管理者**権限。

- CAS サイト データベースでの **Sysadmin** 権限

- プライマリ サイト サーバーでのローカル**管理者**権限

- プライマリ サイトのデータベース サーバーが、プライマリ サイト サーバーから見てリモートにある場合は、プライマリ サイトのリモート サイト データベース サーバーでのローカル**管理者**権限。

- CAS での**インフラストラクチャ管理者**または**完全な権限を持つ管理者**のセキュリティ ロール

### <a name="procedure-to-uninstall-a-primary-site"></a><a name="bkmk_pri-process"></a> プライマリ サイトをアンインストールする手順

Configuration Manager のセットアップを実行して、セカンダリ サイトに関連付けられていないプライマリ サイトをアンインストールします。 以下の手順に従ってプライマリ サイトをアンインストールします。

> [!TIP]
> プライマリ サイト サーバーがもう使用できなくなっている場合は、CAS で階層のメンテナンス ツールを使用して、サイト データベースからプライマリ サイトを削除します。 詳細については、[階層のメンテナンス ツール (Preinst.exe)](../../manage/hierarchy-maintenance-tool-preinst.exe.md) に関するページを参照してください。

1. 以下のいずれかの方法を使用して、プライマリ サイト サーバーで Configuration Manager のセットアップを起動します。

    - **[開始]** メニューで、 **[Configuration Manager のセットアップ]** を選択します。

    - Configuration Manager の*インストール メディア*のディレクトリで、`\SMSSETUP\BIN\X64\setup.exe` を開きます。 このバージョンがサイトのバージョンと同じであることを確認します。

    - Configuration Manager が*インストールされている*ディレクトリで、`\BIN\X64\setup.exe` を開きます。

1. **[開始する前に]** ページの情報を確認します。

1. **[はじめに]** ページで **[Configuration Manager サイト サーバーをアンインストールする]** を選択します。

    > [!IMPORTANT]  
    >  セカンダリ サイトがプライマリ サイトに接続されている場合は、プライマリ サイトをアンインストールする前にセカンダリ サイトを削除する必要があります。  

1. **[Configuration Manager サイトのアンインストール]** ページでは、既定で、以下のオプションの両方が有効になっています。

    - Remove the site database from the primary site server (プライマリ サイト サーバーからサイト データベースを削除する)
    - Remove the Configuration Manager console (Configuration Manager コンソールを削除する)

1. **[はい]** をクリックして、Configuration Manager のプライマリ サイトのアンインストールを確定します。

### <a name="uninstall-a-primary-site-that-uses-distributed-views"></a><a name="bkmk_distviews"></a> 分散ビューを使用しているプライマリ サイトのアンインストール

1. 子プライマリ サイトをアンインストールする前に、階層内にある CAS とプライマリ サイトの間の各リンクに関する分散ビューを無効にします。

1. 各リンクに対する分散ビューを無効にしたら、CAS で、プライマリ サイトのデータの再初期化が完了したことを確認します。 データの初期化を監視するには、[レプリケーションの監視](../../manage/monitor-replication.md)に関するページを参照してください。

1. CAS でデータが正常に再初期化されたら、[プライマリ サイトをアンインストール](#bkmk_pri-process)できます。

1. プライマリ サイトがアンインストールされたら、リンクに関する分散ビューを、CAS から他のプライマリ サイトに再構成できます。

    > [!IMPORTANT]
    > 各サイトで分散ビューを無効にする前や、CAS でプライマリ サイトのデータが正常に再初期化される前にプライマリ サイトをアンインストールした場合は、データ レプリケーションが失敗する可能性があります。

## <a name="decommission-a-hierarchy"></a><a name="bkmk_hierarchy"></a> 階層の使用の停止

一部の組織には、合併、買収、テスト環境、またはその他のビジネス要件が原因で、複数の階層があります。 管理を 1 つの階層に統合する場合は、この操作が、コストと複雑さを軽減する助けになることがあります。 階層の使用を停止するもう 1 つの理由は、Microsoft Intune などのクラウド専用管理サービスに移行しようとしていて、オンプレミスのインフラストラクチャを削除する準備ができていることです。

複数のサイトが含まれる階層の使用を停止するには、削除する順序が重要です。 階層の最下位にあるサイトのアンインストールを開始した後、上方へ進めます。

1. プライマリ サイトに接続されているセカンダリ サイトを削除します。
2. プライマリ サイトをアンインストールします。
3. すべてのプライマリ サイトをアンインストールした後で、CAS をアンインストールできます。

詳細については、以下のセクションを参照してください。

- [セカンダリ サイトの削除](#bkmk_secondary)
- [プライマリ サイトのアンインストール](#bkmk_primary)
- [CAS のアンインストール](#bkmk_uninstall-cas)

### <a name="uninstall-the-cas"></a><a name="bkmk_uninstall-cas"></a> CAS のアンインストール

階層の使用を停止する最後の手順は、CAS のアンインストールです。 Configuration Manager セットアップを実行し、子プライマリ サイトがない CAS をアンインストールします。

#### <a name="prerequisites-to-uninstall-the-cas"></a>CAS をアンインストールするための前提条件

Configuration Manager のセットアップを実行する管理ユーザーには、以下のセキュリティ権限が必要です。

- CAS サーバーでのローカル**管理者**権限

- CAS データベース サーバーがサイト サーバーから見てリモートにある場合は、CAS のリモート サイト データベース サーバーでのローカル**管理者**権限。

#### <a name="procedure-to-uninstall-the-cas"></a>CAS をアンインストールする手順

1. 以下のいずれかの方法を使用して、CAS サーバーで Configuration Manager のセットアップを開始します。

    - **[開始]** メニューで、 **[Configuration Manager のセットアップ]** を選択します。

    - Configuration Manager の*インストール メディア*のディレクトリで、`\SMSSETUP\BIN\X64\setup.exe` を開きます。 このバージョンがサイトのバージョンと同じであることを確認します。

    - Configuration Manager が*インストールされている*ディレクトリで、`\BIN\X64\setup.exe` を開きます。

1. **[開始する前に]** ページの情報を確認します。

1. **[はじめに]** ページで **[Configuration Manager サイト サーバーをアンインストールする]** を選択します。

    > [!IMPORTANT]  
    >  CAS をアンインストールする前に、すべての子プライマリ サイトを削除します。  

1. **[Configuration Manager サイトのアンインストール]** ページでは、既定で、以下のオプションの両方が有効になっています。

    - Remove the site database from the CAS server (CAS サーバーからサイト データベースを削除する)
    - Remove the Configuration Manager console (Configuration Manager コンソールを削除する)

1. **[はい]** を選択して、Configuration Manager の中央管理サイト (CAS) のアンインストールを確定します。

## <a name="remove-the-cas"></a><a name="bkmk_remove-cas"></a> CAS の削除

<!-- 3607277 -->

バージョン 2002 以降、階層が CAS と 1 つの子プライマリ サイトで構成されている場合は、CAS を削除できます。 この操作により、Configuration Manager インフラストラクチャが 1 つのスタンドアロン プライマリ サイトに簡素化されます。 これにより、サイト間レプリケーションの複雑さが解消され、管理タスクが 1 つのサイトに集中されます。

詳細については、[CAS の削除](remove-central-administration-site.md)に関するページを参照してください。
