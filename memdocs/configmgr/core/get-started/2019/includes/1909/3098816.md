---
author: mestew
ms.author: mstewart
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: include
ms.date: 09/26/2019
ms.openlocfilehash: 69ec772da4b5c7696bc5234984910dd7065656ca
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/21/2020
ms.locfileid: "81697720"
---
## <a name="orchestration-groups"></a><a name="bkmk_OGs"></a> オーケストレーション グループ

<!--3098816-->

オーケストレーション グループを作成して、デバイスへのソフトウェア更新プログラムの展開をより細かく制御します。 多くのサーバー管理者は、特定のワークロードの更新プログラムを慎重に管理し、中間の動作を自動化する必要があります。 例:

- あなたは、ソフトウェア更新プログラムの管理者として、組織のためのすべての更新プログラムを管理します。
- あなたは、すべてのサーバーに対する 1 つの大規模なコレクションと、すべてのクライアントに対する 1 つの大規模なコレクションを保持しています。 これらのコレクションにすべての更新プログラムを展開します。
- SQL 管理者は、SQL サーバーにインストールされているすべてのソフトウェアを制御したいと考えています。 5 台のサーバーに、特定の順序で修正プログラムを適用する必要があります。 現在のプロセスでは、特定のサービスを手動で停止してから更新プログラムをインストールし、その後でサービスを再起動しています。
- あなたはオーケストレーション グループを作成し、5 台の SQL サーバーをすべて追加します。 また、SQL 管理者によって提供される PowerShell スクリプトを使って、事前スクリプトと事後スクリプトも追加します。
- 次の更新サイクル中、あなたは通常どおりソフトウェア更新プログラムを作成して、大規模なサーバーのコレクションに展開します。 SQL 管理者が展開を実行すると、オーケストレーション グループによって順序とサービスが自動化されます。

オーケストレーション グループを使用すると、割合や特定の数値、または明示的な順序に基づいて、デバイスを柔軟に更新できます。 また、デバイスで更新プログラムの展開を実行する前後に、PowerShell スクリプトを実行することもできます。

サーバーだけでなく、任意の Configuration Manager クライアントをオーケストレーション グループのメンバーにすることができます。 オーケストレーション グループのルールは、オーケストレーション グループのメンバーを含むすべてのコレクションに対する、すべてのソフトウェア更新プログラムの展開について、デバイスに適用されます。 その他の展開の動作も引き続き適用されます。 たとえば、メメンテナンス期間や展開スケジュールなどです。

> [!NOTE]
> **[オーケストレーション グループ]** 機能は、[[サーバー グループ]](../../../../../sum/deploy-use/service-a-server-group.md) 機能の進化版です。 オーケストレーション グループは、Configuration Manager の新しいオブジェクトです。

### <a name="prerequisites"></a>[前提条件]

- **[オーケストレーション グループ]** 機能を有効にします。 詳細については、[オプション機能の有効化](../../../../servers/manage/install-in-console-updates.md#bkmk_options)に関するページをご覧ください。

    > [!NOTE]
    > **[オーケストレーション グループ]** を有効にすると、サイトによって **[サーバー グループ]** 機能が無効にされます。 この動作により、2 つの機能間の競合が回避されます。

- すべてのオーケストレーション グループとそのグループに対する更新プログラムを表示するには、お使いのアカウントが **[完全な権限を持つ管理者]** である必要があります。

### <a name="try-it-out"></a>試してみましょう。

タスクを実行してみます。 その後、[フィードバック](../../../../understand/find-help.md#product-feedback)で機能についてのご意見をお寄せください。

1. Configuration Manager コンソールで、 **[資産とコンプライアンス]** ワークスペースに移動した後、 **[オーケストレーション グループ]** ノードを選択します。

1. リボンで **[オーケストレーション グループの作成]** を選択して、 **[オーケストレーション グループの作成ウィザード]** を開きます。

1. **[全般]** ページで、オーケストレーション グループの **[名前]** と、必要に応じて **[説明]** を指定します。

1. **[メンバーの選択]** ページで、まず現在の **[サイト コード]** を指定します。 次に、 **[参照]** を選択し、このオーケストレーション グループのメンバーとしてデバイス リソースを追加します。 名前でデバイスを **[検索]** した後、それらを **[追加]** します。 選択したリソースの一覧へのデバイスの追加が完了したら、 **[OK]** を選択します。

    ![[オーケストレーション グループへのリソースの選択] ウィンドウのスクリーンショット](../../media/3098816-select-resources.png)

1. **[ルール選択]** ページで、次のオプションのいずれかを選択します。

   - **[所定の割合のコンピューターの同時更新を許可する]** を選択した後、この割合の数値を選択または入力します。 この設定を使用すると、オーケストレーション グループのサイズに関する柔軟性をさらに高めることができます。 たとえば、オーケストレーション グループに 50 台のデバイスが含まれていて、この値を 10 に設定したとします。 ソフトウェア更新プログラムの展開中、Configuration Manager によって 5 台のデバイスで同時に展開を実行することが許可されます。 後でオーケストレーション グループのサイズを 100 台のデバイスに増やした場合、10 台のデバイスが一度に更新されます。

   - **[複数のコンピューターの同時更新を許可する]** を選択した後、この具体的なカウントに対する数を選択または入力します。 この設定を使用すると、オーケストレーション グループの全体的なサイズにかかわらず、常に特定の数のデバイスに制限できます。

   - **[メンテナンス シーケンスを指定する]** を選択した後、選択したリソースを適切な順序で並べ替えます。 この設定を使用すると、ソフトウェア更新プログラムの展開を実行するデバイスの順序を明示的に定義できます。

1. **[PreScript]** ページで、展開を実行する "*前に*" 各デバイス上で実行する PowerShell スクリプトを入力します。 このスクリプトは、成功した場合は `0` の値を返し、再起動を伴う成功に対しては `3010` を返す必要があります。 また、 **[スクリプト タイムアウト]** の値を指定することもできます。その場合、指定した時間内に完了しなかったスクリプトは失敗します。

1. **[PostScript]** ページで、展開を実行した "*後に*" 各デバイス上で実行する PowerShell スクリプトを入力します。 その動作は、その他の点では PreScript と同じです。

1. ウィザードを完了します。

**[オーケストレーション グループ]** ノードで、オーケストレーション グループを選択します。 リボンで、 **[メンバーの表示]** を選択します。 グループのメンバーと、それぞれのオーケストレーションの状態を確認できます。

オーケストレーション グループの動作をテストするには、そのオーケストレーション グループのメンバーが含まれているコレクションに、[ソフトウェア更新プログラムを展開します](../../../../../sum/deploy-use/deploy-software-updates.md)。 メンテナンスの期限または期間中に、そのグループ内のクライアントがソフトウェア更新プログラムをインストールしようとすると、オーケストレーションが開始されます。 これはグループ全体に対して開始され、オーケストレーション グループのルールに従って確実にデバイスが更新されます。

> [!TIP]
> オーケストレーション グループは、ソフトウェア更新プログラムの展開にのみ適用されます。 その他の展開には適用されません。

### <a name="monitor"></a>モニター

サイト サーバー上の次のログ ファイルを使用すると、監視およびトラブルシューティングに役立ちます。

- **Policypv.log**: サイトがオーケストレーション グループを対象にしていることをクライアントに示します
- **SMS_OrchestrationGroup.log**: オーケストレーション グループの動作を示します

### <a name="orchestration-group-known-issues"></a>オーケストレーション グループに関する既知の問題

- 1 台のコンピューターを複数のオーケストレーション グループに追加しないでください。

- コレクションを検索してオーケストレーション グループのリソースを選択する場合は、 **[すべてのデスクトップ クライアントおよびサーバー クライアント]** のみを選択してください。

- 現在、オーケストレーション グループに対していくつかのアクションを使用できますが、機能するのは既定の **[メンバーの表示]** アクションのみです。 現時点では、このアクションによってデバイスの名前は表示されず、リソース ID のみが表示されます。

- **[オーケストレーションの種類]** の値は、次の種類に対応しています。

    | 値 | オーケストレーションの種類 |
    |-------|---------|
    |**1**|数値|
    |**2**|割合|
    |**3**|シーケンス|

- **[現在の状態]** の値は、次の状態に対応しています。

    | 値 | 現在の状態 |
    |-------|---------|
    |**1**|アイドル|
    |**2**|待機中 (デバイスは順番を待機しています)|
    |**3**|実行中 (更新プログラムのインストール中)|
    |**4**|失敗|
    |**5**|再起動の保留中|
