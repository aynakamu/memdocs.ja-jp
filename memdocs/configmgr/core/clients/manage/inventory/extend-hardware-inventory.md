---
title: ハードウェア インベントリを拡張する
titleSuffix: Configuration Manager
description: Configuration Manager でハードウェア インベントリを拡張する方法を学習します。
ms.date: 03/22/2018
ms.prod: configuration-manager
ms.technology: configmgr-client
ms.topic: conceptual
ms.assetid: d5bfab4f-c55e-4545-877c-5c8db8bc1891
author: mestew
ms.author: mstewart
manager: dougeby
ms.openlocfilehash: 39e88debf5c25fb3a033c322e37663549ead29fd
ms.sourcegitcommit: 48005a260bcb2b97d7fe75809c4bf1552318f50a
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/15/2020
ms.locfileid: "83427724"
---
# <a name="how-to-extend-hardware-inventory-in-configuration-manager"></a>Configuration Manager のハードウェア インベントリの拡張方法

*適用対象:Configuration Manager (Current Branch)*

ハードウェア インベントリは、Windows Management Instrumentation (WMI) を使用して、Windows PC から情報を読み取ります。 WMI は、企業の管理情報にアクセスするための業界標準である Web-Based Enterprise Management (WBEM) を Microsoft が実装したものです。 以前のバージョンの Configuration Manager では、サイト サーバー上のファイル sms_def.mof を変更してハードウェア インベントリを拡張しました。 このファイルには、ハードウェア インベントリで読み取ることができる WMI クラスのリストが含まれていました。 このファイルを編集すると、既存のクラスを有効および無効にでき、インベントリする新しいクラスを作成することもできました。  

Configuration.mof ファイルは、クライアント上でハードウェア インベントリによってインベントリするデータ クラスを定義するために使用し、Configuration Manager 2012 から変更されていません。 クライアント システムに存在する既存またはカスタムの WMI リポジトリ データ クラスまたはレジストリ キーをインベントリする、データ クラスを作成できます。  

 また、Configuration.mof ファイルでは、ハードウェア インベントリ時にデバイス情報にアクセスする WMI プロバイダーを定義および登録します。 プロバイダーを登録することによって、使用するプロバイダーの種類とプロバイダーがサポートするクラスが定義されます。  

 Configuration Manager クライアントがポリシーを要求したときに、ポリシー本文に Configuration.mof が添付されます。 このファイルをクライアントがダウンロードしてコンパイルします。 Configuration.mof ファイルでデータ クラスの追加、変更、または削除が行われると、クライアントは、インベントリ関連のデータ クラスに対して行われたこれらの変更内容を自動的にコンパイルします。 構成マネージャー クライアントで新規または変更されたデータ クラスをインベントリするための追加の操作は必要ありません。 このファイルはプライマリ サイト サーバーの **<CMInstallLocation\>\Inboxes\clifiles.src\hinv\\** にあります。  

 Configuration Manager では、Configuration Manager 2007 で行ったように sms_def.mof ファイルを編集する必要がなくなりました。 代わりに、WMI クラスを有効または無効にし、クライアント設定を使用して、ハードウェア インベントリで収集する新しいクラスを追加できます。 Configuration Manager では、以下の方法を使用してハードウェア インベントリを拡張できます。  

> [!NOTE]  
>  カスタム インベントリ クラスを追加するために Configuration.mof ファイルを手動で変更した場合は、バージョン 1602 への更新時に、これらの変更が上書きされます。 更新後にカスタム クラスを引き続き使用するには、1602 への更新後に、Configuration.mof ファイルの "Added extensions" セクションにカスタム クラスを追加する必要があります。  
> ただし、このセクションの上にある記述は変更しないでください。これらのセクションは Configuration Manager による変更のために予約されています。 カスタム Configuration.mof のバックアップは、  
> **<CM のインストール ディレクトリ\>\data\hinvarchive\\** にあります。  

## <a name="methods"></a>メソッド

### <a name="enable-or-disable"></a>有効または無効にする

クライアントに既に存在するクラスの全属性のうち一部を有効または無効にします。 このアクションでは、それをクライアントで収集するようにハードウェア インベントリ エージェントに指示します。 このアクションは、既定のクライアント設定またはカスタム デバイス クライアント設定で行うことができます。 詳細については、「[既存のインベントリ クラスを有効または無効にするには](#BKMK_Enable)」を参照してください。

### <a name="add"></a>追加

WMI クラスがクライアント上に存在し、サイトで認識されている場合、このアクションにより、ハードウェア インベントリ クラスの可能なセットにそのクラスが追加されます。 別のデバイスの WMI 名前空間から新しいインベントリ クラスを追加できます。 このアクションは、既定のクライアント設定に対してのみ実行されます。 詳細については、「[新しいインベントリ クラスを追加するには](#BKMK_Add)」を参照してください。

### <a name="extend"></a>延長

新しい WMI クラスをクライアントに追加します。 ハードウェア インベントリを手動で拡張するには、最上位サイトの configuration.mof を編集します。<!-- SCCMDocs#1073 -->

WMI クラスがクライアントにまだ存在しない場合は、次のようにして WMI スキーマを拡張する必要があります。

1. 最上位サイトの configuration.mof を編集します。 サイトで追加されたことを **dataldr.log** で確認します。

1. クライアントのポリシーを更新し、新しいクラスがコンパイルされるのを待ちます。

1. 既定のクライアント設定を使用して、新しいクラスをハードウェア インベントリに[追加](#add)します。 既定のクライアント設定では、このクラスを有効にする必要はありません。 その後、カスタム デバイス クライアント設定で有効にすることができます。

### <a name="import-and-export"></a>インポートとエクスポート

Configuration Manager コンソールを使用してインベントリ クラスが含まれている管理オブジェクト フォーマット (MOF) ファイルをインポートおよびエクスポートします。 詳細については、「[ハードウェア インベントリ クラスをインポートする](#BKMK_Import)」と「[ハードウェア インベントリ クラスをエクスポートする](#BKMK_Export)」を参照してください。

### <a name="create-noidmif-files"></a>NOIDMIF ファイルを作成する

NOIDMIF ファイルを使って、Configuration Manager ではインベントリできないクライアント デバイスに関する情報を収集します。 たとえば、デバイス上にラベルとしてのみ存在するデバイス資産番号情報を収集します。 NOIDMIF のインベントリは、収集元のクライアント デバイスに自動的に関連付けられます。 詳細については、「[NOIDMIF ファイルを作成する](#BKMK_NOIDMIF)」を参照してください。

### <a name="create-idmif-files"></a>IDMIF ファイルを作成する

IDMIF ファイルは、構成マネージャー クライアントに関連付けられていない組織内の資産に関する情報を収集するために使用します。 たとえば、プロジェクター、複写機、ネットワーク プリンターなどです。 詳細については、「[IDMIF ファイルを作成する](#BKMK_IDMIF)」を参照してください。

## <a name="procedures-to-extend-hardware-inventory"></a>ハードウェア インベントリを拡張する手順

この手順に従うと、ハードウェア インベントリに既定のクライアント設定を構成して、これらの設定を階層内のすべてのクライアントに適用できます。 これらの設定を一部のクライアントにのみ適用するには、カスタム クライアント デバイス設定を作成して、特定のクライアントのコレクションに割り当てます。 詳しくは、「[クライアント設定を構成する方法](../../../../core/clients/deploy/configure-client-settings.md)」をご覧ください。  

### <a name="enable-or-disable-existing-inventory-classes"></a><a name="BKMK_Enable"></a> 既存のインベントリ クラスを有効または無効にする  

1. Configuration Manager コンソールで、 **[管理]**  >  **[クライアント設定]**  >  **[既定のクライアント設定]** の順に選択します。  

1. **[ホーム]** タブの **[プロパティ]** グループで、 **[プロパティ]** を選択します。  

1. **[既定のクライアント設定]** ダイアログ ボックスで、 **[ハードウェア インベントリ]** を選択します。  

1. **[デバイス設定]** の一覧で、 **[クラスの設定]** を選択します。  

1. **[ハードウェア インベントリ クラス]** ダイアログ ボックスで、ハードウェア インベントリで収集するクラスおよびクラス プロパティをオンまたはオフにします。 クラスを展開して、そのクラス内の個々のプロパティをオンまたはオフにできます。 個々のクラスを検索するには、 **[インベントリ クラスの検索]** フィールドを使用します。  

    > [!IMPORTANT]  
    >  構成マネージャー ハードウェア インベントリに新しいクラスを追加すると、収集されてサイト サーバーに送信されるインベントリ ファイルのサイズが大きくなります。 そのため、ネットワークと Configuration Manager サイトのパフォーマンスが低下する可能性があります。 収集するインベントリ クラスのみ有効にしてください。  

### <a name="add-a-new-inventory-class"></a><a name="BKMK_Add"></a> 新しいインベントリ クラスを追加する  

インベントリ クラスは、既定のクライアント設定を変更して、階層の最上位のサーバーからのみ追加できます。 このオプションは、カスタム デバイス設定を作成する場合は使用できません。

1. Configuration Manager コンソールで、 **[管理]**  >  **[クライアント設定]**  >  **[既定のクライアント設定]** の順に選択します。  

1. **[ホーム]** タブの **[プロパティ]** グループで、 **[プロパティ]** を選択します。  

1. **[既定のクライアント設定]** ダイアログ ボックスで、 **[ハードウェア インベントリ]** を選択します。  

1. **[デバイス設定]** リストで、 **[クラスの設定]** を選択します。  

1. **[ハードウェア インベントリ クラス]** ダイアログ ボックスで、 **[追加]** を選択します。  

1. **[ハードウェア インベントリ クラスの追加]** ダイアログ ボックスで、 **[接続]** を選択します。  

1. **[Windows Management Instrumentation (WMI) に接続]** ダイアログ ボックスで、WMI クラスを取得するコンピューターの名前、およびクラスの取得に使用する WMI 名前空間を指定します。 指定した WMI 名前空間のすべてのクラスを取得する場合は、 **[繰り返し]** を選択します。 接続しているコンピューターがローカル コンピューターでない場合は、リモート コンピューターの WMI へのアクセス許可があるアカウントの資格情報を指定します。

1. **[接続]** を選択します。  

1. **[ハードウェア インベントリ クラスの追加]** ダイアログ ボックスの **[インベントリ クラス]** の一覧で、構成マネージャー ハードウェア インベントリに追加する WMI クラスを選択します。  

1. 選択した WMI クラスに関する情報を編集するには、 **[編集]** を選択して、 **[クラスの修飾子]** ダイアログ ボックスに以下の情報を指定します。  

    - **[表示名]** :この名前はリソース エクスプローラーに表示されます。  

    - **プロパティ**:WMI クラスの各プロパティを表示する単位を指定します。  

      クラスの各インスタンスを一意に識別できるように、プロパティをキー プロパティとして設定することもできます。 クラスにキーが定義されておらず、クラスの複数のインスタンスがクライアントからレポートされる場合は、見つかった最新のインスタンスのみデータベースに格納されます。  

      プロパティの構成が終了したら、 **[OK]** を選択して **[クラスの修飾子]** ダイアログ ボックスとその他の開いているダイアログを閉じます。

### <a name="import-hardware-inventory-classes"></a><a name="BKMK_Import"></a> ハードウェア インベントリ クラスをインポートする

既定のクライアント設定を変更している場合は、インベントリ クラスのみインポートできます。 ただし、カスタム クライアント設定を使用して、 **[True]** から **[False]** への既存のクラスのプロパティの変更などの、スキーマ変更が含まれていない情報をインポートできます。  

1. Configuration Manager コンソールで、 **[管理]**  >   **[クライアント設定]**  >  **[既定のクライアント設定]** の順に選択します。

1. **[ホーム]** タブの **[プロパティ]** グループで、 **[プロパティ]** を選択します。  

1. **[既定のクライアント設定]** ダイアログ ボックスで、 **[ハードウェア インベントリ]** を選択します。  

1. **[デバイス設定]** リストで、 **[クラスの設定]** を選択します。  

1. **[ハードウェア インベントリ クラス]** ダイアログ ボックスで、 **[インポート]** を選択します。  

1. **[インポート]** ダイアログ ボックスで、インポートするマネージド オブジェクト フォーマット (MOF) ファイルを選択し、 **[OK]** を選択します。 インポートされる項目を確認したら、 **[インポート]** を選択します。  

### <a name="export-hardware-inventory-classes"></a><a name="BKMK_Export"></a> ハードウェア インベントリ クラスをエクスポートする  

1. Configuration Manager コンソールで、 **[管理]**  >  **[クライアント設定]**  >  **[既定のクライアント設定]** の順に選択します。  

1. **[ホーム]** タブの **[プロパティ]** グループで、 **[プロパティ]** を選択します。  

1. **[既定のクライアント設定]** ダイアログ ボックスで、 **[ハードウェア インベントリ]** を選択します。  

1. **[デバイス設定]** リストで、 **[クラスの設定]** を選択します。  

1. **[ハードウェア インベントリ クラス]** ダイアログ ボックスで、 **[エクスポート]** を選択します。  

    > [!NOTE]  
    > クラスをエクスポートする際、現在選択されているすべてのクラスがエクスポートされます。  

1. **[エクスポート]** ダイアログ ボックスで、クラスをエクスポートするマネージド オブジェクト フォーマット (MOF) ファイルを指定し、 **[保存]** を選択します。  

### <a name="configure-hardware-inventory-to-collect-strings-larger-than-255-characters"></a><a name="bkmk_GreaterThan255"></a> 255 文字以上の文字列を収集するようにハードウェア インベントリを構成する

ハードウェア インベントリ プロパティに対して、文字列の長さを 255 文字以上に指定できます。 このアクションは、新しく追加されたクラスと、キーではないハードウェア インベントリ プロパティに対してのみ適用されます。 <!-- 1357389 -->

1. **[管理]** ワークスペースで **[クライアント設定]** を選択します。 編集するクライアント デバイス設定を選択し、 **[プロパティ]** を選択します。

1. **[ハードウェア インベントリ]** 、 **[クラスの設定]** 、 **[追加]** の順に選択します。

1. **[接続]** を選択します。

1. **[コンピューター名]** 、 **[WMI 名前空間]** を入力し、必要に応じて **[再帰]** を選択します。 接続するために必要な場合は、資格情報を指定します。 **[接続]** を選択して、名前空間クラスを表示します。

1. 新しいクラスを選択してから **[編集]** を選択します。

1. キー以外の、文字列であるプロパティの **[長さ]** を変更し、255 より大きい値になるようにします。 **[OK]** を選択します。

1. **[ハードウェア インベントリ クラスの追加]** で編集したプロパティが選択されていることを確認して、 **[OK]** を選択します。

## <a name="use-mif-files-to-extend-hardware-inventory"></a>MIF ファイルを使用したハードウェア インベントリの拡張

管理情報フォーマット (MIF) ファイルを使用して、Configuration Manager によってクライアントから収集されるハードウェア インベントリ情報を拡張します。 ハードウェアのインベントリ時に、MIF ファイルに保存された情報はクライアント インベントリ レポートに追加され、サイト データベースに保存されます。サイト データベースでは、既定のクライアント インベントリ データを使用するのと同じようにデータを使用できます。 MIF ファイルには 2 つの種類があります。NOIDMIF と IDMIF です。

> [!IMPORTANT]  
> MIF ファイルの情報を Configuration Manager データベースに追加する前に、そのクラス情報を作成またはインポートする必要があります。 詳細については、この記事の「 [新しいインベントリ クラスを追加するには](#BKMK_Add) 」セクションと「 [ハードウェア インベントリ クラスをインポートするには](#BKMK_Import) 」セクションを参照してください。  

### <a name="create-noidmif-files"></a><a name="BKMK_NOIDMIF"></a> NOIDMIF ファイルを作成する

NOIDMIF ファイルを使用すると、Configuration Manager では通常収集できない、特定のクライアント デバイスに関連付けられている情報をクライアント ハードウェア インベントリに追加できます。 たとえば、多くの企業では、組織内の各コンピューターに資産番号を示すラベルを付けてから、これらの番号を手動でカタログ化しています。 NOIDMIF ファイルを作成すると、この情報を Configuration Manager データベースに追加してクエリやレポートに使用できます。 NOIDMIF ファイルの作成の詳細については、Configuration Manager の SDK ドキュメントをご覧ください。  

> [!IMPORTANT]  
> NOIDMIF ファイルを作成するときに、ANSI でエンコードされた形式で保存する必要があります。 NOIDMIF ファイルを UTF-8 でエンコードされた形式で保存すると、Configuration Manager で読み取ることができません。  

NOIDMIF ファイルを作成したら、各クライアントの `%Windir%\CCM\Inventory\Noidmifs` フォルダーに保存します。 Configuration Manager は、次回のスケジュールされたハードウェア インベントリ サイクル中に、このフォルダーの NODMIF ファイルから情報を収集します。  

### <a name="create-idmif-files"></a><a name="BKMK_IDMIF"></a> IDMIF ファイルを作成する

IDMIF ファイルを使用すると、Configuration Manager では通常インベントリできない、特定のクライアント デバイスに関連付けられていない資産に関する情報を Configuration Manager データベースに追加できます。 たとえば、IDMIFS を使用して、プロジェクター、DVD プレーヤー、複写機、または構成マネージャー クライアントが含まれていないその他の機器に関する情報を収集できます。 IDMIF ファイルの作成の詳細については、Configuration Manager の SDK ドキュメントをご覧ください。  

IDMIF ファイルを作成したら、クライアント コンピューターの `%Windir%\CCM\Inventory\Idmifs` フォルダーに保存します。 Configuration Manager は、次回のスケジュールされたハードウェア インベントリ サイクル中に、このファイルから情報を収集します。 クラスを追加またはインポートして、ファイルに含まれる情報の新しいクラスを宣言します。  

> [!NOTE]
> MIF ファイルは大量のデータを格納することができ、このデータを収集するのはサイトのパフォーマンスに悪影響を与える場合があります。 MIF コレクションは必要なときだけ有効化し、ハードウェア インベントリ設定の **[カスタム MIF ファイルの最大サイズ (KB)]** オプションを構成します。 詳しくは、「[ハードウェア インベントリの概要](introduction-to-hardware-inventory.md)」をご覧ください。
