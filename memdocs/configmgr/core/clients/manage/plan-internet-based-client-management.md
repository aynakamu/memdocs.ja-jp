---
title: インターネット ベースのクライアント管理
titleSuffix: Configuration Manager
description: Configuration Manager でインターネット ベースのクライアントを管理する計画を作成します。
ms.date: 04/29/2020
ms.prod: configuration-manager
ms.technology: configmgr-client
ms.topic: conceptual
ms.assetid: 83a7c934-3b11-435d-ba22-cbc274951e83
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: f7054c75643c6ffa37decba74f9fe85831728985
ms.sourcegitcommit: b7e5b053dfa260e7383a9744558d50245f2bccdc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/29/2020
ms.locfileid: "82587223"
---
# <a name="plan-for-internet-based-client-management-in-configuration-manager"></a>Configuration Manager でインターネット ベースのクライアント管理を計画する

*適用対象:Configuration Manager (Current Branch)*

内部ネットワークに接続されていない構成マネージャー クライアントを管理するには、インターネット ベースのクライアント管理 (IBCM) を使用します。 IBCM を使用すると次のような利点があります。

- サービスを提供するサーバーと役割を完全に制御できます
- クラウド サービスの依存関係はありません
- 仮想プライベート ネットワーク (VPN) が必要ない場合があります
- すべてのコストが、オンプレミスのサービスに関連付けられます

パブリック ネットワーク上のクライアント コンピューターを管理するには高いセキュリティが必要であるため、IBCM では PKI 証明書を使用する必要があります。 この構成により、独立した機関によって接続が認証されます。 IBCM クライアントとサイト サーバーによって送信されるデータは、暗号化され、セキュリティで保護されます。  

## <a name="client-communications"></a>クライアントの通信

プライマリ サイトでの次のサイト システムの役割では、信頼されていない場所にあるクライアントからの接続がサポートされます。

> [!NOTE]
> IBCM の主な対象はインターネット ベースのシナリオですが、信頼されていない Active Directory フォレストのクライアントにも、同じ動作が適用されます。 セカンダリ サイトでは、信頼されていない場所からのクライアント接続はサポートされていません。

- Configuration Manager ポリシー モジュールに対する証明書登録ポイント (NDES)

- 配布ポイント

- クラウドベースの配布ポイント

- 登録プロキシ ポイント

- フォールバック ステータス ポイント

- 管理ポイント

- ソフトウェアの更新ポイント

> [!NOTE]
> アプリケーション カタログの役割のサポートは、バージョン 1910 で終了しました。 詳細については、「[アプリケーション カタログの削除](../../../apps/plan-design/plan-for-and-configure-application-management.md#bkmk_remove-appcat)」を参照してください。 まだサポートされているバージョン 1906 以前の Configuration Manager の場合、アプリケーション カタログ Web サイト ポイントでは、インターネット ベースのクライアントからの接続を受け入れることができます。

### <a name="about-internet-facing-site-systems"></a>インターネットに接続するサイト システムについて

クライアントのフォレストとサイト システム サーバーのフォレストとの間に信頼関係を構築する必要はありません。 ただし、インターネットに接続するサイト システムを含むフォレストがユーザー アカウントを含むフォレストを信頼している状態で、 **[クライアント ポリシー]** のクライアント設定 **[インターネット クライアントからのユーザー ポリシー要求を有効にする]** を有効にした場合は、この構成でインターネット上のデバイスのユーザーベース ポリシーがサポートされます。

たとえば、次の構成は、IBCM でインターネット上のデバイスに対するユーザー ポリシーがサポートされる場合を示したものです。

- インターネット ベースの管理ポイントは、境界ネットワーク内にあります。 また、そのネットワークには、ユーザーを認証するための読み取り専用ドメイン コントローラーがあります。 境界ネットワークと内部ネットワークの間のファイアウォールでは、Active Directory パケットが許可されます。

- ユーザー アカウントは、イントラネット ベースのフォレスト内にあります。 インターネット ベースの管理ポイントは、境界ベースのフォレスト内にあります。 内部フォレストは、境界フォレストによって信頼されています。 境界ネットワークと内部ネットワークの間のファイアウォールでは、認証パケットが許可されます。

- ユーザー アカウントとインターネット ベースの管理ポイントはどちらも、イントラネット ベースのフォレスト内にあります。 Web プロキシ サーバーを使用して、管理ポイントをインターネットに公開します。

### <a name="use-a-web-proxy-server"></a>Web プロキシ サーバーを使用する

インターネット ベースのサイト システムは、Web プロキシサーバーを使用してインターネットに公開するときは、イントラネット内に配置できます。 これらのサイト システムを、インターネットからのクライアント接続専用、またはインターネットとイントラネットからのクライアント接続用に構成します。 Web プロキシ サーバーを使用する場合は、Secure Sockets Layer (SSL) または SSL トンネリングに対する SSL ブリッジング用にそれを構成できます。

#### <a name="ssl-bridging-to-ssl"></a>SSL への SSL ブリッジング

SSL への SSL ブリッジングは、認証付きの SSL ターミネーションが使用されるため、推奨される安全性の高い構成です。 コンピューター認証を使用して、クライアント コンピューターの認証が行われます。 Configuration Manager に登録したモバイル デバイスでは、SSL ブリッジングはサポートされません。

プロキシでの SSL ターミネーションでは、インターネットからのパケットは、内部ネットワークに転送される前に検査されます。 プロキシでは、クライアントからの接続が認証されて終了された後、インターネット ベースのサイト システムに対する認証済みの新しい接続が開かれます。 構成マネージャー クライアントでプロキシを使用すると、クライアントの ID (GUID) がパケット ペイロード内に安全に格納されます。 管理ポイントでは、プロキシはクライアントと見なされません。 Configuration Manager では、HTTP から HTTPS、または HTTPS から HTTP へのブリッジはサポートされていません。

> [!NOTE]
> Configuration Manager では、サードパーティの SSL ブリッジ構成の設定はサポートされていません。 たとえば、Citrix Netscaler や F5 BIG-IP などです。 これらを Configuration Manager で使用する場合の構成については、デバイスのベンダーにお問い合わせください。

#### <a name="tunneling"></a>トンネリング

お使いのプロキシ Web サーバーで SSL ブリッジングの要件をサポートできない場合、Configuration Manager では SSL トンネリングもサポートされています。 また、SSL トンネリングを使用すると、Configuration Manager に登録したモバイル デバイスをサポートすることもできます。 ただし、これは安全性の低いオプションです。なぜなら、プロキシによって、インターネットからの SSL パケットが SSL ターミネーションなしにサイト システムに転送されるためです。 プロキシでは、パケットの内容が悪意のあるものかどうかは検査されません。 SSL トンネリングを使用する場合は、プロキシ Web サーバーに証明書は必要ありません。

## <a name="plan-for-internet-based-clients"></a>インターネット ベースのクライアントを計画する

インターネット ベースのクライアントを、イントラネットとインターネット両方での管理用に構成するか、またはインターネットのみのクライアント管理用に構成するかを決定します。 この管理オプションは、クライアントのインストール時にのみ構成できます。 後で変更するには、クライアントを再インストールします。

> [!NOTE]
> インターネット ベースのクライアントをサポートするための管理ポイントを構成した場合、この管理ポイントに接続するクライアントは、利用可能な管理ポイントのリストが次に更新された時点で、インターネット対応になります。
>
> インターネットのみのクライアント管理の構成を、インターネットだけに制限する必要はありません。 イントラネットでもそれを使用できます。

インターネットのみの管理用に構成されたクライアントは、インターネットからのクライアント接続用に構成されたサイト システムだけと通信します。 この構成は、次のシナリオで使用します。

- イントラネットに接続しないことがわかっているコンピューターの場合。 たとえば、リモートの場所にある販売時点管理コンピューターなどです。
- クライアント通信を HTTPS のみに制限する場合。 たとえば、ファイアウォールと制限されたセキュリティ ポリシーをサポートする場合などです。
- インターネット ベースのサイト システムを境界ネットワークにインストールし、これらのサーバーを構成マネージャー クライアントとして管理する場合。

> [!NOTE]
> インターネット上のワークグループ クライアントを管理する場合は、これらのクライアントをインターネット専用としてインストールします。
>
> イントーネット ベースの管理ポイントを使用するようにモバイル デバイスを構成すると、自動的にインターネット専用として構成されます。

他のクライアントを、インターネットとイントラネット両方のクライアント管理用に構成できます。 それらでは、ネットワークの変更が検出されると、IBCM とイントラネット クライアント管理が自動的に切り替わります。 これらのクライアントは、イントラネット上でクライアント接続をサポートする管理ポイントを発見して接続できる場合は、イントラネット クライアントとして管理されます。 イントラネット クライアントは、すべての Configuration Manager 機能を備えています。 イントラネット上でクライアント接続をサポートする管理ポイントを発見または接続できないクライアントの場合は、インターネット ベースの管理ポイントへの接続が試みられます。 この操作が成功すると、これらのクライアントは、割り当てられたサイト内のインターネット ベースのサイト システムによって管理されます。

自動切り替えの利点は、クライアントが、イントラネットに接続したときはすべての機能を使用でき、インターネット上にあるときは必要な管理を受けることです。 インターネット上で開始したコンテンツ ダウンロードを、イントラネットでシームレスに再開することや、その逆のことが可能です。

## <a name="prerequisites"></a>[前提条件]

Configuration Manager での IBCM には、以下の依存関係があります。

- クライアントがインターネットに接続できる必要があります。 Configuration Manager では、デバイスの既存のインターネット接続が使用されます。 モバイル デバイスは、インターネットに直接接続されている必要があります。 完全なクライアント コンピューターは、インターネットに直接接続するか、プロキシ Web サーバーを使用して接続することができます。

- IBCM をサポートするサイト システムでは、インターネット接続が必要であり、Active Directory ドメイン内に存在する必要があります。 インターネット ベースのサイト システムとサイト サーバーの Active Directory フォレストの間に、信頼関係は必要ありません。 ただし、インターネット ベースの管理ポイントで Windows 認証を使用してユーザーを認証できる場合は、ユーザー ポリシーがサポートされます。 Windows 認証が失敗した場合は、デバイス ポリシーのみがサポートされます。

    > [!NOTE]
    > ユーザー ポリシーをサポートするには、 **[クライアント ポリシー]** グループで次のクライアント設定も有効にします。
    >
    > - **クライアント上でのユーザー ポリシーのポーリングを有効にする**
    > - **インターネット クライアントからのユーザー ポリシー要求を有効にする**  

- インターネット ベースのクライアントとサイト システムのサーバーに必要な証明書を展開および管理するための公開キー基盤 (PKI)。 詳細については、「[PKI 証明書の要件](../../plan-design/network/pki-certificate-requirements.md)」を参照してください。

- IBCM をサポートするサイト システムのインターネット完全修飾ドメイン名 (FQDN) に対するパブリック DNS ホスト エントリを登録します。

### <a name="client-communication-requirements"></a>クライアント通信の要件

中間に存在するファイアウォールまたはプロキシ サーバーでは、インターネット ベースのサイト システムに対するクライアントの通信を許可する必要があります。

- HTTP 1.1 をサポートしていること  

- マルチパート MIME 添付ファイルの HTTP コンテンツ タイプ (multipart/mixed および application/octet-stream) を許可すること  

#### <a name="verbs"></a>動詞

インターネット ベースのサイト システム サーバーの役割に対して、次の動詞を許可します。

| Role | 動詞 |
|------|-------|
| 管理ポイント | - HEAD<br>- CCM_POST<br>- BITS_POST<br>- GET<br>- PROPFIND |
| 配布ポイント | - HEAD<br>- GET<br>- PROPFIND |
| フォールバック ステータス ポイント | POST |
| アプリケーション カタログ Web サイト ポイント | -POST<br>-GET |

#### <a name="http-headers"></a>HTTP ヘッダー

インターネット ベースのサイト システム サーバーの役割に対して、次の HTTP ヘッダーを許可します。

| Role | HTTP ヘッダー |
|------|--------------|
| 管理ポイント | - Range:<br>- CCMClientID:<br>- CCMClientIDSignature:<br>- CCMClientTimestamp:<br>- CCMClientTimestampsSignature: |
| 配布ポイント | 範囲: |

インターネットからのクライアント接続にソフトウェアの更新ポイントを使用する場合は、Windows Server Update Services (WSUS) のドキュメントをご覧ください。

## <a name="unsupported-features"></a>サポートされていない機能

すべてのクライアント管理機能がインターネットに適しているわけではありません。 Configuration Manager の一部の機能は、インターネット上のクライアントに対してサポートされていません。 これらのサポートされていない機能は、通常、Active Directory Domain Services に依存するものか、またはパブリック ネットワークに適していないものです。

IBCM でインターネット上のクライアントを管理する場合、次の機能はサポートされません。

- クライアントのプッシュ インストールやソフトウェア更新プログラムに基づいたクライアントの展開など、インターネット上でのクライアントの展開。 手動でクライアントをインストールしてください。

- サイトの自動割り当て

- Wake On LAN

- OS の展開。 ただし、OS が展開されないタスク シーケンスを展開することはできます。

- リモート コントロール

- ユーザーへのソフトウェアの展開。 この機能は、非推奨になったアプリケーション カタログに依存しています。

- クライアントのローミング。 ローミングによって、クライアントが常に一番近い配布ポイントを見つけて、コンテンツをダウンロードできるようになります。 クライアントでは、帯域幅や物理的な場所に関係なく、インターネット ベースのサイト システムのいずれかが無作為に選択されます。

インターネットからの接続を受け付けるようにソフトウェアの更新ポイントを構成すると、インターネット ベースのクライアントでは、常に、このソフトウェアの更新ポイントがスキャンされて、必要なソフトウェア更新プログラムが特定されます。 これらのクライアントがインターネット上にある場合は、インターネット ベースの配布ポイントからではなく、まず Microsoft Update からソフトウェア更新プログラムのダウンロードが試みられます。 この動作が失敗した場合は、インターネット ベースの配布ポイントから、必要なソフトウェア更新プログラムのダウンロードが試みられます。

> [!TIP]
> Configuration Manager クライアントは、イントラネット上にあるか、インターネット上にあるかを自動的に判断します。 クライアントがドメイン コントローラーまたはオンプレミスの管理ポイントに接続できる場合、その接続の種類が [現在は "*イントラネット*"] に設定されます。 それ以外の場合は、[現在は "*インターネット*"] に切り替わり、サイトに割り当てられているサイト システムとの通信が行われます。
