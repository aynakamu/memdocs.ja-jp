---
title: ファイルベースのレプリケーション
titleSuffix: Configuration Manager
description: Configuration Manager がファイルベースのレプリケーションを使用して階層内のサイト間でデータを転送する方法について説明します。
ms.date: 08/09/2019
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 65fcc1a8-214e-4dd9-8093-de4cd4a00442
author: mestew
ms.author: mstewart
manager: dougeby
ms.openlocfilehash: b7d7f1564057a7a942fc4a32064eb54cdbfa890d
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/21/2020
ms.locfileid: "81703560"
---
# <a name="file-based-replication"></a>ファイルベースのレプリケーション

*適用対象:Configuration Manager (Current Branch)*

Configuration Manager のファイルベースのレプリケーションは、ファイルに入っているデータを階層内のサイト間で転送する方法です。 このデータには、子サイトの配布ポイントに展開するアプリケーションとパッケージが含まれます。 また、親サイトに転送されて処理される未処理の探索データ レコードも処理されます。  

サイト間のファイルベースの通信では、TCP/IP ポート 445 で *Server Message Block* (SMB) プロトコルを使用します。 サイトからネットワーク経由で転送されるデータの量を制御するには、帯域幅調整とパルス モードを指定します。 また、スケジュールを使用して、ネットワーク経由でデータを送信するタイミングを制御します。  

## <a name="routes"></a><a name="bkmk_routes"></a> ルート

次の情報は、ファイル レプリケーション ルートを設定して使用するのに役立ちます。  

### <a name="file-replication-route"></a>ファイル レプリケーション ルート

各ファイル レプリケーション ルートは、サイトによるファイルベースのデータの転送先サイトを識別します。 各サイトでは、特定の転送先サイト 1 つにつき、1 つのファイル レプリケーション ルートを使用できます。  

ファイル レプリケーション ルートを管理するには、 **[管理]** ワークスペースに移動します。 **[階層の構成]** ノードを展開し、 **[ファイル レプリケーション]** を選択します。  

ファイル レプリケーション ルートの次の設定を変更できます。  

#### <a name="file-replication-account"></a>ファイル レプリケーション アカウント

このアカウントでは、転送先サイトに接続してそのサイトの **SMS_Site** 共有にデータを書き込みます。 この共有に書き込まれたデータは受信側サイトで処理されます。 既定では、階層にサイトを追加すると、Configuration Manager によって、新しいサイト サーバーのコンピューター アカウントが、そのファイル レプリケーション アカウントとして割り当てられます。 次に、このアカウントが宛先サイトの `SMS_SiteToSiteConnection_<sitecode>` グループに追加されます。 このグループはコンピューター上でローカルであり、SMS_Site 共有へのアクセスを許可します。 このアカウントを Windows ユーザー アカウントに変更できます。 アカウントを変更する場合は、必ず、接続先サイトの `SMS_SiteToSiteConnection_<sitecode>` グループに新しいアカウントを追加してください。  

> [!NOTE]  
> セカンダリ サイトでは、常に、セカンダリ サイト サーバーのコンピューター アカウントを **ファイル レプリケーション アカウント**として使用します。  

#### <a name="schedule"></a>スケジュール

各ファイル レプリケーション ルートのスケジュールを設定します。 この操作により、データの種類と、データを宛先サイトに転送できるときが制限されます。  

#### <a name="rate-limits"></a>転送率の制限

各ファイル レプリケーション ルートのレート制限を指定します。 この操作により、サイトによってデータが宛先サイトに転送されるときにサイトで使用されるネットワーク帯域幅が制御されます。  

- **パルス モード**: サイトから転送先サイトに送信されるデータ ブロックのサイズを指定します。 また、データ ブロックを送信する間隔を指定することもできます。 このオプションは、帯域幅が小さなネットワーク接続でデータを転送先サイトに送信しなければならない場合に使用してください。

    たとえば、3 秒に 1 KB ではなく、5 秒に 1 KB のデータを送信しなければならない場合などです。 この制約は、リンク速度や特定の時間帯の使用率には関係ありません。

- **指定された時間帯の最大転送率を制限する**: 指定した時間のレートだけを使用して、データが転送先サイトに送信されます。 Configuration Manager ではネットワークの使用可能な帯域幅が特定されません。 データを送信できる時間が分割されます。 その分割された短い時間にデータが送信され、次にデータが送信されない時間が続きます。

    たとえば、最大転送率を **50%** に設定します。 Configuration Manager ではある一定の時間だけデータが転送され、その後、同じ長さの時間だけ転送が停止されます。 送信されるデータ ブロックの実際のサイズは管理されません。 サイトではデータが送信される時間だけが管理されます。  

    > [!CAUTION]  
    > 既定では、サイトがデータを転送するときは、 **送信スレッドを同時に** 3 本まで使用できます。 ファイル レプリケーション ルートの転送率の制限を有効にすると、そのサイトへの**同時送信数** が 1 つに制限されます。 これは、 **[使用可能な帯域幅の制限 (%)]** を **100%** に設定した場合も当てはまります。 たとえば、センダーの既定の設定を使用する場合、この制限により、サイトへの転送速度が既定の 3 分の 1 に低下します。  

#### <a name="routes-between-secondary-sites"></a>セカンダリ サイト間のルート

2 つのセカンダリ サイト間でファイル レプリケーション ルートを構成し、これらのサイト間でファイルベースのコンテンツをルーティングします。  


### <a name="sender"></a>センダー

サイトごとにセンダーが 1 つあります。 センダーによって、1 つのサイトから宛先サイトへのネットワーク接続が管理されます。 これによって、同時に複数サイトへの接続が確立されます。 サイトに接続するために、センダーはサイトへのファイル レプリケーション ルートを使用し、ネットワーク接続の確立に使用するアカウントを識別します。 また、センダーはこのアカウントを使用して、転送先サイトの SMS_Site 共有にデータを書き込みます。  

既定では、センダーは、複数の**同時送信**つまり "*スレッド*" を使用して宛先サイトにデータを書き込みます。 スレッドごとに、個別のファイルベース オブジェクトを転送先サイトに転送できます。 センダーでオブジェクトの送信が開始されると、オブジェクト全体が送信されるまで、そのオブジェクトのデータ ブロックが書き込まれます。 オブジェクトのすべてのデータが送信されると、そのスレッドで新しいオブジェクトの送信を開始できるようになります。  

サイトのセンダーを管理するには、 **[管理]** ワークスペースを開き、 **[サイトの構成]** ノードを展開します。 **[サイト]** ノードを選択し、管理するサイトの **[プロパティ]** を選択します。 **[センダー]** タブに切り替えて、センダーの設定を変更します。  

センダーの次の設定を変更できます。  

#### <a name="maximum-concurrent-sendings"></a>最大同時送信数

既定では、各サイトは 5 つの同時送信 (スレッド) を使用します。 いずれか 1 つの転送先サイトにデータを送信するときに、3 つのスレッドを使用できます。 この数を増やすと、サイト間のデータのスループットを上げることができます。 スレッドが増えると、Configuration Manager が同時に転送できるファイルが増えます。 ただし、この数を増やすと、サイト間で必要なネットワーク帯域幅も大きくなります。  

#### <a name="retry-settings"></a>再試行の設定

既定では、各サイトは、接続に問題があった場合に、1 分間隔で 2 回接続を再試行します。 この再試行回数と間隔は、変更することができます。  


## <a name="next-steps"></a>次のステップ

[Database replication](database-replication.md)
