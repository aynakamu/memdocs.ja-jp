---
title: サイト階層の設計
titleSuffix: Configuration Manager
description: Configuration Manager で使用できるトポロジと管理オプションを理解することで、サイト階層を計画できます。
ms.date: 07/30/2018
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 07ce872e-1558-42ad-b5ad-582c5b1bdbb4
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 3c642e97589ff345e4eb3a17b63b3fdfbc2891f9
ms.sourcegitcommit: bbf820c35414bf2cba356f30fe047c1a34c5384d
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/21/2020
ms.locfileid: "81703590"
---
# <a name="design-a-hierarchy-of-sites-for-configuration-manager"></a>Configuration Manager のサイト階層の設計

*適用対象:Configuration Manager (Current Branch)*

新しい Configuration Manager 階層の最初のサイトをインストールする前に、以下のことを理解しておくことをお勧めします。  

- Configuration Manager で使用できるトポロジ  

- 使用可能なサイトの種類と相互の関係  

- 各種のサイトが提供する管理のスコープ  

- インストールする必要があるサイトの数を減らすためのコンテンツ管理オプション  

次に、現在のビジネス ニーズに対して効率的に機能し、将来の成長の管理のために拡張できるトポロジを計画します。  

計画時には、追加のサイトを階層またはスタンドアロン サイトに追加する際の以下の制限に注意してください。  

- 中央管理サイトの下にインストールできる新しいプライマリ サイトは、階層で[サポートされるプライマリ サイトの数](../configs/size-and-scale-numbers.md)が上限になります。  

- [スタンドアロン プライマリ サイトを拡張して新しい中央管理サイトをインストール](../../servers/deploy/install/prerequisites-for-installing-sites.md#bkmk_expand)します。そうすることで、追加のプライマリ サイトをインストールできるようになります。  

- プライマリ サイトの下にインストールできる新しいセカンダリ サイトの数は、[プライマリ サイトでサポートされている上限](../configs/size-and-scale-numbers.md)、および階層全体でサポートされている上限までになります。  

- 以前にインストールされたサイトを既存の階層に追加して 2 つのスタンドアロン サイトをマージすることはできません。 Configuration Manager では、既存の階層に対して新しいサイトのインストールのみがサポートされています。  


> [!NOTE]  
> Configuration Manager の新規インストールを計画するときは、[リリース ノート](../../servers/deploy/install/release-notes.md)でアクティブなバージョンでの現在の問題の詳細を確認してください。 リリース ノートは、Configuration Manager のすべてのブランチに適用されます。 [Technical Preview ブランチ](../../get-started/technical-preview.md)を使用する場合は、Technical Preview の各バージョンのドキュメントで、そのブランチに固有の問題を確認してください。  



##  <a name="hierarchy-topology"></a><a name="bkmk_topology"></a> 階層トポロジ  

階層トポロジの範囲は以下のとおりです。  

- 最も単純:単一のスタンドアロン プライマリ サイト  

- 最も複雑:階層の最上位にある中央管理サイトに接続されているプライマリ サイトおよびセカンダリ サイトのグループ  

階層で使用するサイトの種類と数を決定するうえで通常重要となるのは、サポートする必要があるデバイスの数と種類です。   

### <a name="standalone-primary-site"></a>スタンドアロン プライマリ サイト

スタンドアロン プライマリ サイトがすべてのデバイスおよびユーザーの管理をサポートできる場合は、このサイトを使用します。 詳細については、「[サイズとスケールの数](../configs/size-and-scale-numbers.md)」を参照してください。 このトポロジは、会社の地理的な場所を 1 つのプライマリ サイトで正常にサービスできる場合にも有効です。 ネットワーク トラフィックを管理しやすくするには、境界グループ内の複数の管理ポイント、および慎重に計画されたコンテンツ インフラストラクチャを使用します。 詳細については、「[境界グループを構成する](../../servers/deploy/configure/boundary-groups.md)」および「[コンテンツ管理の基本的な概念](fundamental-concepts-for-content-management.md)」を参照してください。  

このトポロジには、以下のメリットがあります。  

- 管理オーバーヘッドが簡略化される  

- クライアント サイトの割り当てと、使用可能なリソースとサービスの検出が簡略化される  

- サイト間におけるデータベース レプリケーションによって生じる可能性がある遅延が解消される  

- スタントアロン プライマリ サイトを、中央管理サイトを使用した、より大きな階層に拡張することもできる。 このようにすると、新しいプライマリ サイトをインストールして、展開の規模を大きくすることができます。  


### <a name="central-administration-site-with-one-or-more-child-primary-sites"></a>1 つまたは複数の子プライマリ サイトが含まれる中央管理サイト 

このトポロジは、すべてのデバイスとユーザーの管理をサポートするのに複数のプライマリ サイトが必要な場合に使用します。 これは、複数のプライマリ サイトを使用する必要がある場合には必須です。 

このトポロジには、以下のメリットがあります。  

- 階層の規模を拡張するために、最大で 25 のプライマリ サイトがサポートされる。    

- 常に中央管理サイトを使用する (サイトを再インストールする場合を除く)。 このオプションは、元に戻すことができません。 子プライマリ サイトを切り離して、スタンドアロン プライマリ サイトにすることはできません。  



##  <a name="determine-when-to-use-a-central-administration-site"></a><a name="BKMK_ChooseCAS"></a> 中央管理サイトを使用する場合の判別  

中央管理サイトは、階層全体の設定を構成して、階層内のすべてのサイトとオブジェクトを監視する場所です。 このサイトの種類では、クライアントを直接管理しません。 階層全体のサイトやクライアントの構成を含め、サイト間のデータ レプリケーションを調整します。  

以下の情報を参考にして、中央管理サイトをインストールするかどうかを判別できます。  

- 中央管理サイトは、階層の最上位のサイトです。  

- 複数のプライマリ サイトが含まれる階層を構成する場合は、中央管理サイトをインストールします。  

     - 複数のプライマリ サイトがすぐに必要な場合は、まず中央管理サイトをインストールします。  

     - 既にプライマリ サイトがある状態で中央管理サイトをインストールする場合は、中央管理サイトをインストールするために、[スタンドアロン プライマリ サイトを展開します](../../servers/deploy/install/prerequisites-for-installing-sites.md#bkmk_expand)。  

- 中央管理サイトは、プライマリ サイトのみ子サイトとしてサポートします。  

- 中央管理サイトにクライアントを割り当てることはできません。  

- 中央管理サイトは、管理ポイントや配布ポイントなどのクライアントを直接サポートするサイト システムの役割はサポートしていません。  

- 中央管理サイトに接続された Configuration Manager コンソールから、階層内のすべてのクライアントを管理し、すべてのサイト管理タスクを実行します。 これらのタスクには、子プライマリ サイトまたはセカンダリ サイトにおける管理ポイントや他のサイト システムの役割のインストールが含まれます。  

- 中央管理サイトを使用する場合、このサイトは、ご使用の階層内のすべてのサイトのサイト データが表示される唯一の場所です。 このデータには、インベントリ データやステータス メッセージなどの情報が含まれます。  

- 中央管理サイトから、階層全体の探索処理を構成します。 中央管理サイトから、個々のプライマリ サイトで実行する探索方法を割り当てます。  

- 別々のセキュリティ ロール、セキュリティ スコープ、およびコレクションを異なる管理ユーザーに割り当てて、階層全体のセキュリティを管理します。 この構成は、階層内の各サイトに適用されます。  

- 階層内のサイト間の通信を制御するレプリケーションを構成します。 サイト データのデータベース レプリケーションをスケジュール設定し、サイト間のファイルベースのデータの転送に使用する帯域幅を管理します。  



##  <a name="determine-when-to-use-a-primary-site"></a><a name="BKMK_ChoosePriimary"></a> プライマリ サイトを使用する場合の判別  

プライマリ サイトは、クライアントを管理するために使用します。 プライマリ サイトは、中央管理サイトの下の子サイトとしてインストールするか、新しいサイトの 1 番目のサイトとしてインストールします。 新しい階層の 1 番目のサイトであるプライマリ サイトは、スタンドアロン プライマリ サイトになります。 子プライマリ サイトもスタンドアロン プライマリ サイトも、セカンダリ サイトを持つことができます。  

次のような場合にプライマリ サイトの追加を検討します。  

- 1 つの階層で管理するデバイスの数を増やすため。  

- 組織の管理要件を満たすため。 たとえば、リモートの場所にプライマリ サイトをインストールして、低帯域幅のネットワーク経由で展開コンテンツの転送を管理できます。  

     - 代わりに、データを配布ポイントに転送するときのネットワーク帯域幅を調整するオプションを使用することを検討します。 そのコンテンツ管理機能を使用すれば、追加のサイトをインストールしなくて済みます。  


以下の情報は、プライマリ サイトをいつインストールするかを決めるのに役立ちます。  

- プライマリ サイトをスタンドアロン プライマリ サイトにすることも、大規模な階層内の子プライマリ サイトにすることもできます。 中央管理サイトのある階層にプライマリ サイトを含める場合は、これらのサイト間でデータベースのレプリケーションが行われます。 大量のクライアントとデバイスがあり、1 つのプライマリ サイトでは管理しきれない場合を除き、スタンドアロン プライマリ サイトをインストールすることを検討します。 スタンドアロン プライマリ サイトをインストールした後、将来必要に応じて、展開を拡大するために新しい中央管理サイトに報告するように拡張します。  

- プライマリ サイトの親になれるのは、中央管理サイトだけです。  

- 一方、プライマリ サイトの子になれるのは、セカンダリ サイトだけで、複数のセカンダリ サイトをサポートします。  

- プライマリ サイトは、割り当てられたクライアントのすべてのクライアント データを処理します。  

- プライマリ サイトは、データベース レプリケーションを使用して中央管理サイトと直接通信します。 この動作は、新しいサイトのインストール時に自動的に構成されます。  



##  <a name="determine-when-to-use-a-secondary-site"></a><a name="BKMK_ChooseSecondary"></a> セカンダリ サイトを使用する場合の判別  

セカンダリ サイトは、低帯域幅のネットワーク経由で展開コンテンツとクライアント データの転送を管理するために使用します。  

セカンダリ サイトは、中央管理サイトまたはセカンダリ サイトの直接の親プライマリ サイトから管理します。 セカンダリ サイトはプライマリ サイトに接続されます。 セカンダリ サイトを別の親サイトに移動するには、セカンダリ サイトをアンインストールして、新しいプライマリ サイトの下に子サイトとして再インストールする必要があります。

ただし、2 つのピアのセカンダリ サイト間でコンテンツをルーティングでき、展開コンテンツのファイルベースのレプリケーションを管理するのに役立ちます。 セカンダリ サイトは、クライアント データをプライマリ サイトに転送するために、ファイルベースのレプリケーションを使用します。 親プライマリ サイトと通信するために、データベース レプリケーションも使用します。  

次の条件のいずれかが当てはまる場合は、セカンダリ サイトのインストールを検討します。  

- 管理ユーザーのローカル接続ポイントは必要ありません。  

- 階層内の下位サイトへの展開コンテンツの転送を管理する必要があります。  

- 階層内の上位サイトに送信されるクライアント情報を管理する必要があります。  

セカンダリ サイトをインストールしないことを希望しており、リモートの場所にクライアントがある場合は、以下のオプションを検討します。  

- Windows BranchCache などのピア ツー ピア テクノロジを使用する  

- 帯域幅の制御とスケジューリングのための配布ポイントを有効にする   

これらのコンテンツ管理オプションは、セカンダリ サイトの有無に関係なく使用します。 これらは、Configuration Manager のインフラストラクチャの数を削減するのに役立ちます。 Configuration Manager でのコンテンツ管理オプションの詳細については、「[コンテンツ管理オプションを使用する場合の判別](#BKMK_ChooseSecondaryorDP)」を参照してください。  


以下の情報を参考にして、セカンダリ サイトをインストールするかどうかを判別できます。  

- セカンダリ サイト サーバーでは、SQL Server のローカル インスタンスが使用できない場合、サイトのインストール時に SQL Server Express が自動的にインストールされます。  

- セカンダリ サイトのインストールは、コンピューター上でセットアップを直接実行するのではなく、Configuration Manager コンソールから開始されます。  

- セカンダリ サイトは、サイト データベース内の情報の一部を使用します。 この動作により、親プライマリ サイトとセカンダリ サイト間で SQL によって複製されるデータ量が削減されます。  

- セカンダリ サイトは、共通の親プライマリ サイトを持つ他のセカンダリ サイトへの、ファイルベースのコンテンツのルーティングをサポートします。  

- セカンダリ サイトのインストール時に、セカンダリ サイト サーバー上に、管理ポイントと配布ポイントのサイト システムの役割が自動的にインストールされます。  



##  <a name="determine-when-to-use-content-management-options"></a><a name="BKMK_ChooseSecondaryorDP"></a> コンテンツ管理オプションを使用する場合の判別  

リモートのネットワークの場所にクライアントがある場合、プライマリ サイトまたはセカンダリ サイトの代わりにコンテンツ管理オプションを使用することを検討します。 以下のオプションを使用すると、多くの場合にサイトをインストールする必要がなくなります。  

- Windows 10 の配信の最適化  

- Configuration Manager のピア キャッシュ  

- Windows BranchCache  

- 帯域幅の制御用の配布ポイントの構成  

- 配布ポイントへのコンテンツの手動コピー (コンテンツの事前設定)  


次の条件のいずれかが当てはまる場合は、別のサイトをインストールする代わりに配布ポイントを展開することを検討します。  

- ネットワーク帯域幅が、リモートの場所のクライアント コンピューターがプライマリ サイトの管理ポイントと通信するのに十分である。 クライアントは管理ポイントと通信して、クライアント ポリシーをダウンロードしたり、インベントリ、レポート ステータス、および探索情報を送信したりします。  

- バック グラウンド インテリジェント転送サービス (BITS) が、ネットワーク要件に対して十分な帯域幅の制御を提供しない。  

Configuration Manager でのコンテンツ管理オプションの詳細については、「[コンテンツ管理の基本的な概念](fundamental-concepts-for-content-management.md)」を参照してください。  



##  <a name="beyond-hierarchy-topology"></a><a name="bkmk_beyond"></a> 階層トポロジ以外  

最初の階層トポロジと併せて、以下の点も検討します。  

- どのサイト システムの役割が、階層内のさまざまなサイトのサービスや機能を提供するか。  

- インフラストラクチャ内で階層全体にわたる構成および機能をどのように管理するか。  


以下の一般的な考慮事項については、別の記事で説明します。 この情報は、階層の設計に影響を与えたり、影響を受けたりするうえで重要です。  

- [コンピューターとデバイスの管理](../../clients/manage/manage-clients.md)を準備するときに、デバイスがオンプレミスであるか、クラウド内にあるか、またはユーザーが所有するデバイス (BYOD) を含めるかどうかを検討します。 また、複数の管理オプションをサポートするデバイスを管理する方法を検討します。 たとえば、Configuration Manager で、または Microsoft Intune と統合することで、Windows 10 デバイスを管理します。 詳細については、「[デバイス管理ソリューションの選択](../choose-a-device-management-solution.md)」を参照してください。  

- 利用可能なネットワーク インフラストラクチャが、リモートの場所の間のデータ フローにどのような影響を及ぼすかを理解しておきます。 詳細については、[ネットワーク環境の準備](../network/configure-firewalls-ports-domains.md)に関する記事を参照してください。 また、ユーザーとデバイスの地理的な場所、およびユーザーやデバイスが対象のインフラストラクチャにアクセスするときにオンプレミスのネットワークとインターネットのどちらを使用するかを検討します。  

- 管理対象デバイスに展開するコンテンツを効率的に配信するためのコンテンツ インフラストラクチャを計画します。 このコンテンツには、アプリケーション、ソフトウェア更新プログラム、オペレーティング システムなどがあります。 詳細については、「[コンテンツ管理インフラストラクチャの展開と管理](../../servers/deploy/configure/manage-content-and-content-infrastructure.md)」をご覧ください。  

- 使用する予定の [Configuration Manager の特徴と機能](../changes/features-and-capabilities.md)を決定します。 異なる機能には、異なるサイト システムの役割または Windows インフラストラクチャが必要です。 ネットワークやサーバー リソースを最も効率的に使用するために、複数のサイト階層内のどの場所にそれらの特徴や機能を展開するかを決定します。  

- 公開キー基盤 (PKI) の使用を含む、データとデバイスのセキュリティを検討します。 詳細については、「[PKI 証明書の要件](../network/pki-certificate-requirements.md)」を参照してください。  


サイト固有の構成については、以下の記事をご覧ください。  

- [SMS プロバイダーの計画](plan-for-the-sms-provider.md)  

- [サイト データベースの計画](plan-for-the-site-database.md)  

- [サイト システム サーバーとサイト システムの役割の計画](plan-for-site-system-servers-and-site-system-roles.md)  

- [セキュリティの計画](../security/plan-for-security.md)  

- [Managing network bandwidth](manage-network-bandwidth.md) (サイト内のコンテンツを展開するとき)  


複数のサイトと階層にまたがる構成を検討します。  

- サイトと階層の[高可用性オプション](../../servers/deploy/configure/high-availability-options.md)

- [Active Directory スキーマの拡張](../network/extend-the-active-directory-schema.md)と、[サイト データを発行](../../servers/deploy/configure/publish-site-data.md)するサイトの構成  

- [サイト間のデータ転送](data-transfers-between-sites.md)  

- [ロール ベース管理の基礎](../../understand/fundamentals-of-role-based-administration.md)  

- [インターネット上のクライアントを管理する](../../clients/manage/manage-clients-internet.md)  

