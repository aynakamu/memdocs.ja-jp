---
title: 段階的展開の作成
titleSuffix: Configuration Manager
description: 複数コレクションへのソフトウェアのロールアウトを自動化するには、段階的展開を使用します。
ms.date: 08/21/2020
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: how-to
ms.assetid: b634ff68-b909-48d2-9e2c-0933486673c5
author: mestew
ms.author: mstewart
manager: dougeby
ms.openlocfilehash: 71e7f9c23b55beecc98bffb5da73465f0681a4a4
ms.sourcegitcommit: 8fc1704ed0e1141f46662bdd32b52bec00fb93b4
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/09/2020
ms.locfileid: "89606397"
---
# <a name="create-phased-deployments-with-configuration-manager"></a>Configuration Manager で段階的展開を作成する

*適用対象:Configuration Manager (Current Branch)*

段階的展開は、複数のコレクションでのソフトウェアの調整および順序付けされたロールアウトを自動化します。 たとえば、ソフトウェアをパイロット コレクションに展開し、成功条件に基づいてロールアウトを自動続行します。 既定の 2 フェーズで段階的展開を作成するか、複数のフェーズを手動で構成します。

以下のオブジェクトの段階的展開を作成します。

- **タスク シーケンス**
  - タスク シーケンスの段階的展開では、PXE やメディアのインストールはサポートされません
- **アプリケーション**。 <!--1358147-->  
- **ソフトウェア更新プログラム** <!--1358146-->  
  - 段階的な展開で自動展開規則 (ADR) を使用することはできません

## <a name="prerequisites"></a>[前提条件]

### <a name="security-scope"></a>セキュリティ スコープ

段階的展開によって作成された展開は、 **[すべて]** セキュリティ スコープを持たない管理ユーザーには表示されません。 詳細については、「 [セキュリティ スコープ](../../core/understand/fundamentals-of-role-based-administration.md#bkmk_PlanScope)」をご覧ください。

### <a name="distribute-content"></a>コンテンツの配布

段階的展開を作成する前に、配布ポイントに関連するコンテンツを配布します。<!--518293-->  

- **アプリケーション**: コンソールでターゲット アプリケーションを選択し、リボンの **[コンテンツの配布]** 操作を使用します。 詳細については、[コンテンツの展開と管理](../../core/servers/deploy/configure/deploy-and-manage-content.md)に関するページを参照してください。

- **タスク シーケンス**: タスク シーケンスを作成する前に、OS アップグレード パッケージなどの参照先オブジェクトを作成する必要があります。 展開を作成する前に、これらのオブジェクトを配布します。 各オブジェクト、またはタスク シーケンスで **[コンテンツの配布]** 操作を使用します。 すべての参照先コンテンツの状態を表示するには、タスク シーケンスを選択し、詳細ウィンドウの **[参照]** タブに切り替えます。 詳細については、[OS の展開の準備](../get-started/prepare-for-operating-system-deployment.md)に関するページの特定のオブジェクトの種類を参照してください。

- **ソフトウェア更新プログラム**: 展開パッケージを作成して配布します。 ソフトウェア更新プログラムのダウンロード ウィザードを使用します。 詳しくは、「[ソフトウェア更新プログラムのダウンロード](../../sum/deploy-use/download-software-updates.md)」をご覧ください。  

## <a name="phase-settings"></a><a name="bkmk_settings"></a> フェーズの設定

これらの設定は段階的展開に固有のものです。 フェーズを作成または編集するときにこれらの設定を構成して、段階的展開プロセスのスケジュールと動作を制御します。

バージョン 2002 以降では、次の Windows PowerShell コマンドレットを使用して、ソフトウェア更新プログラム用のフェーズとタスク シーケンスの段階的な展開を手動で構成します。

- [New-CMSoftwareUpdatePhase](/powershell/module/configurationmanager/new-cmsoftwareupdatephase)
- [New-CMTaskSequencePhase](/powershell/module/configurationmanager/new-cmtasksequencephase)

### <a name="criteria-for-success-of-the-first-phase"></a>最初のフェーズの成功の基準

- **[展開の成功率]** :最初のフェーズが成功するために展開を正常に完了する必要のあるデバイスの割合を指定します。 既定値は 95% です。 つまり、この展開で 95% のデバイスのコンプライアンス状態が**成功**のとき、サイトは最初のフェーズが成功したものと見なします。 その後、サイトは第 2 のフェーズを続行し、次のコレクションに対するソフトウェアの展開を作成します。

- **正常に展開されたデバイスの数**: 最初のフェーズが成功するために展開を正常に完了する必要のあるデバイスの数を指定します。 このオプションは、コレクションの数が変動し、次のフェーズに移る前に特定の数の成功したデバイスを示す必要がある場合に役立ちます。 <!--3555946-->

### <a name="conditions-for-beginning-second-phase-of-deployment-after-success-of-the-first-phase"></a>最初のフェーズが成功した後、配置の第 2 フェーズを開始するための条件  

- **[この段階は遅延期間 (日数) の後、自動的に開始する]** :最初のフェーズが成功した後に第 2 フェーズを開始するまでに待機する日数を選択します。 既定値は 1 日です。  

- **[第 2 段階の展開を手動で開始する]** :第 1 フェーズが成功した後、サイトは第 2 フェーズを自動的に開始しません。 このオプションでは、第 2 フェーズを手動で開始する必要があります。 詳しくは、「[次の段階に移行する](manage-monitor-phased-deployments.md#bkmk_move)」をご覧ください。  

    > [!Note]  
    > このオプションは、アプリケーションの段階的展開には使用できません。  

### <a name="gradually-make-this-software-available-over-this-period-of-time-in-days"></a>この期間 (日数) の間、このソフトウェアを段階的に利用できるようにする
<!--1358578-->
各フェーズのロールアウトを段階的に行うためこの設定を構成します。 この動作は展開に関する問題のリスクを軽減するのに役立ち、クライアントへのコンテンツの配布によるネットワークの負荷を減少させます。 サイトは、各フェーズの構成に基づいて、ソフトウェアを段階的に利用可能にします。 フェーズ内の各クライアントには、ソフトウェアが利用可能になった時間に基づく期限が設定されます。 利用可能時間と期限の間の時間枠は、フェーズ内のすべてのクライアントで同じです。 この設定の既定値は 0 です。したがって、既定では展開は調整されません。 30 より大きい値には設定しないでください。<!--SCCMDocs-pr issue 2767-->

![設定を成功させるための段階的展開の条件](media/phased-deployment-criteria-for-success.png)

### <a name="configure-the-deadline-behavior-relative-to-when-the-software-is-made-available"></a>ソフトウェアが使用可能になる場合の、期限に達したときの動作を設定する

- **[直ちにインストールが必要]** :デバイスが対象になったらすぐに、デバイスのインストール期限を設定します。  

- **[この期間の後にインストールが必要]** :デバイスが対象となってから一定の日数後にインストールの期限を設定します。 既定値は 7 日です。

## <a name="automatically-create-a-default-two-phase-deployment"></a><a name="bkmk_auto"></a> 既定の 2 フェーズの展開を自動的に作成する

1. Configuration Manager コンソールで段階的な展開の作成ウィザードを開始します。 このアクションは、展開しているソフトウェアの種類によって異なります。  

    - **アプリケーション**: **[ソフトウェア ライブラリ]** に移動し、 **[アプリケーション管理]** を展開して **[アプリケーション]** を選択します。 既存のアプリケーションを選択してから、リボンの **[段階的な展開の作成]** を選びます。  

    - **ソフトウェア更新プログラム**: **[ソフトウェア ライブラリ]** に移動し、 **[ソフトウェア更新プログラム]** を展開して、 **[すべてのソフトウェア更新プログラム]** を選択します。 1 つまたは複数の更新プログラムを選択してから、リボンで **[段階的な展開の作成]** を選びます。  

        この操作は、次のノードのソフトウェア更新プログラムで使用できます。  
        - ソフトウェア更新プログラム  
            - **すべてのソフトウェア更新プログラム**  
            - **ソフトウェア更新プログラム グループ**
        - Windows 10 サービス、**すべての Windows 10 更新プログラム**  
        - Office 365 クライアント管理、**Office 365 の更新プログラム**  

    - **タスク シーケンス**: **[ソフトウェア ライブラリ]** ワークスペースに移動し、 **[オペレーティング システム]** を展開して、 **[タスク シーケンス]** を選択します。 既存のタスク シーケンスを選択してから、リボンの **[段階的な展開の作成]** を選びます。  

2. **[全般]** ページで、段階的展開の **[名前]** と **[説明]** (省略可能) を指定し、 **[既定の 2 つの段階の展開を自動的に作成する]** を選びます。  

3. **[参照]** を選択し、 **[最初のコレクション]** および **[2 番目のコレクション]** フィールドの両方のターゲット コレクションを選びます。 タスク シーケンスとソフトウェア更新プログラムでは、デバイス コレクションから選択します。 アプリケーションでは、ユーザー コレクションまたはデバイス コレクションから選択します。 **[次へ]** を選択します。  

    > [!Important]  
    > 展開が高リスクの可能性がある場合、段階的な展開の作成ウィザードは通知しません。 詳しくは、「[Settings to manage high-risk deployments](../../core/servers/manage/settings-to-manage-high-risk-deployments.md)」(高リスクの展開を管理するための設定) および「[タスク シーケンスの展開](deploy-a-task-sequence.md)」の注意をご覧ください。  

4. **[設定]** ページで、スケジュール設定ごとに 1 つのオプションを選択します。 詳細については、「[フェーズの設定](#bkmk_settings)」をご覧ください。 完了したら **[次へ]** を選択します。  

5. **[フェーズ]** ページで、指定したコレクションに対してウィザードが作成する 2 つのフェーズを確認します。 **[次へ]** を選択します。 これらの手順では、既定の 2 フェーズの展開を自動的に作成する手順について説明します。 ウィザードでは、段階的展開のフェーズの追加、削除、順序変更、編集、表示を行うことができます。 これらの追加アクションについて詳しくは、「[手動で構成したフェーズを使用して段階的展開を作成する](#bkmk_manual)」をご覧ください。  

6. **[概要]** タブで選択内容を確認してから、 **[次へ]** を選択してウィザードを完了します。  

> [!NOTE]
> 2020 年 4 月 21 日以降、Office 365 ProPlus は、**Microsoft 365 Apps for enterprise** に名前が変更されます。 詳細については、「[Office 365 ProPlus の名前の変更](/deployoffice/name-change)」を参照してください。 コンソールの更新中は、Configuration Manager 製品やドキュメントに古い名前が表示される場合があります。  

バージョン 2002 以降では、次の Windows PowerShell コマンドレットを使用してこのタスクを実行できます。

- [New-CMApplicationAutoPhasedDeployment](/powershell/module/configurationmanager/new-cmapplicationautophaseddeployment)
- [New-CMSoftwareUpdateAutoPhasedDeployment](/powershell/module/configurationmanager/new-cmsoftwareupdateautophaseddeployment)
- [New-CMTaskSequenceAutoPhasedDeployment](/powershell/module/configurationmanager/new-cmtasksequenceautophaseddeployment)

## <a name="create-a-phased-deployment-with-manually-configured-phases"></a><a name="bkmk_manual"></a> 手動で構成したフェーズを使用して段階的展開を作成する
<!--1358148-->

タスク シーケンス用に手動で構成したフェーズを使用して段階的展開を作成します。 段階的展開の作成ウィザードの **[フェーズ]** タブから、最大 10 個のフェーズを追加します。

> [!Note]  
> 現在、アプリケーションのフェーズを手動で作成することはできません。 ウィザードでは、アプリケーションの展開のフェーズが 2 つ自動的に作成されます。

1. タスク シーケンスまたはソフトウェア更新プログラムのいずれかの段階的展開の作成ウィザードを起動します。  

1. 段階的展開の作成ウィザードの **[全般]** ページで、段階的展開の **[名前]** と **[説明]** (省略可能) を指定して、 **[すべてのフェーズを手動で構成する]** を選択します。  

1. 段階的展開の作成ウィザードの **[フェーズ]** ページでは、次のアクションを使用できます。  

    - 展開フェーズの一覧の **[フィルター]** 。 [順序]、[名前]、または [コレクション] 列の照合文字列を入力します (大文字と小文字の区別なし)。

    - 新しいフェーズの **[追加]** :  

        1. フェーズの追加ウィザードの **[全般]** ページで、フェーズの **[名前]** を指定して、対象の **[フェーズのコレクション]** を参照します。 このページの他の設定は、タスク シーケンスまたはソフトウェア更新プログラムの通常展開の場合と同じです。  

        1. フェーズの追加ウィザードの **[フェーズの設定]** ページで、スケジュールの設定を構成し、完了したら **[次へ]** を選択します。 詳しくは、「[設定](#bkmk_settings)」をご覧ください。

            > [!Note]  
            > 最初のフェーズのフェーズの設定 **[展開の成功率]** または **[正常に展開されたデバイスの数]** を編集することはできません。 これらの設定は、前にフェーズがあるフェーズにのみ適用されます。

        1. フェーズの追加ウィザードの **[ユーザー エクスペリエンス]** ページと **[配布ポイント]** ページの設定は、タスク シーケンスまたはソフトウェア更新プログラムの通常展開と同じです。  

        1. **[概要]** ページで設定を確認し、フェーズの追加ウィザードを完了します。  

    - **編集**:この操作では選択されたフェーズのプロパティ ウィンドウが開きます。このウィンドウには、フェーズの追加ウィザードのページと同じタブがあります。  

    - **削除**: この操作では選択されたフェーズが削除されます。  

       > [!Warning]  
       > 確認はなく、このアクションを元に戻す方法はありません。  

    - **[上へ移動]** または **[下へ移動]** :ウィザードは、追加方法によってフェーズを並べ替えます。 最後に追加されたフェーズは、一覧の最後になります。 順序を変更するには、フェーズを選択し、これらのボタンを使用して、一覧内でのフェーズの位置を移動します。  

       > [!Important]  
       > 順序を変更した後、フェーズ設定を確認します。 次の設定がこの段階的展開の要件とまだ一致することを確認します。  
       >
       > - 前のフェーズが成功したかどうかの基準  
       > - 前のフェーズが成功した後に展開のこのフェーズを開始するための条件

1. **[次へ]** を選択します。 **[概要]** ページで設定を確認し、段階的な展開の作成ウィザードを完了します。

バージョン 2002 以降では、次の Windows PowerShell コマンドレットを使用してこのタスクを実行できます。

- [New-CMSoftwareUpdateManualPhasedDeployment](/powershell/module/configurationmanager/new-cmsoftwareupdatemanualphaseddeployment)
- [New-CMTaskSequenceManualPhasedDeployment](/powershell/module/configurationmanager/new-cmtasksequencemanualphaseddeployment)

段階的展開を作成した後、そのプロパティを開いて変更します。  

- 既存の段階的展開に新しいフェーズを**追加**します。  

- フェーズがアクティブでない場合は、**編集**、**削除**、または上下に**移動**できます。 アクティブなフェーズの前には移動できません。  

- アクティブなフェーズは読み取り専用です。 編集、削除、または一覧内での位置変更はできません。 唯一のオプションは、フェーズのプロパティの**表示**です。  

- アプリケーションの段階的展開は常に読み取り専用です。  

## <a name="next-steps"></a>次のステップ

段階的展開を管理および監視する:

- [アプリケーション](manage-monitor-phased-deployments.md?toc=/mem/configmgr/apps/toc.json&bc=/mem/configmgr/apps/breadcrumb/toc.json)。
- [ソフトウェア更新プログラム](manage-monitor-phased-deployments.md?toc=/mem/configmgr/sum/toc.json&bc=/mem/configmgr/sum/breadcrumb/toc.json)  
- [タスク シーケンス](manage-monitor-phased-deployments.md)  
