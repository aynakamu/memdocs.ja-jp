---
title: スタンドアロン メディアの作成
titleSuffix: Configuration Manager
description: ネットワークに接続せずにコンピューターに OS を展開するには、スタンドアロン メディアを使用します。
ms.date: 05/02/2019
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: how-to
ms.assetid: c6b9ccd2-78d9-4f0e-b25a-70d0866300ba
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 62c667706a9d77b3bb7d2b6bbdfde3cde8bb8365
ms.sourcegitcommit: d225ccaa67ebee444002571dc8f289624db80d10
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/12/2020
ms.locfileid: "88125187"
---
# <a name="create-stand-alone-media"></a>スタンドアロン メディアの作成

*適用対象:Configuration Manager (Current Branch)*

Configuration Manager のスタンドアロン メディアには、ネットワークに接続せずにコンピューターに OS を展開するために必要なすべてが含まれています。

次の OS 展開シナリオでは、スタンドアロン メディアを使用します。  

- [新しいバージョンの Windows で既存のコンピューターを更新する](refresh-an-existing-computer-with-a-new-version-of-windows.md)  

- [新しいコンピューター (ベア メタル) に新しいバージョンの Windows をインストールする](install-new-windows-version-new-computer-bare-metal.md)  

- [Windows を最新バージョンにアップグレードする](upgrade-windows-to-the-latest-version.md)  


## <a name="usage"></a>使用方法

スタンドアロン メディアには、OS、およびその他の必要なすべてのコンテンツをインストールするためのステップを自動化するタスク シーケンスが含まれています。 このコンテンツには、ブート イメージ、OS イメージ、およびデバイス ドライバーが含まれます。 スタンドアロン メディアには OS を展開するためのすべてが格納されるため、他の種類のメディアに必要なディスク領域よりも多くのディスク領域が必要になります。

中央管理サイトにスタンドアロン メディアを作成すると、クライアントは割り当てられたサイト コードを Active Directory から取得します。 子サイトで作成されたスタンドアロン メディアは、そのサイトのサイト コードをクライアントに自動的に割り当てます。  


## <a name="prerequisites"></a>[前提条件]

タスク シーケンス メディアの作成ウィザードを使用して、スタンドアロン メディアを作成する前に、これらの条件がすべて満たされていることを確認してください。

### <a name="create-a-task-sequence-to-deploy-an-os"></a>OS を展開するためのタスク シーケンスの作成

スタンドアロン メディアの一部として、OS を展開するタスク シーケンスを指定します。 詳しくは、[OS をインストールするタスク シーケンスの作成](create-a-task-sequence-to-install-an-operating-system.md)に関するページをご覧ください。

#### <a name="unsupported-actions-for-stand-alone-media"></a>スタンドアロン メディアでサポートされていないアクション

スタンドアロン メディアでは、次の操作はサポートされていません。

- タスク シーケンスの [[ドライバーの自動適用]](../understand/task-sequence-steps.md#BKMK_AutoApplyDrivers) ステップ。 スタンドアロン メディアでは、ドライバー カタログからのデバイス ドライバーの自動適用はサポートされません。 指定された一連のドライバーを Windows セットアップで使用できるようにするには、[[ドライバー パッケージの適用]](../understand/task-sequence-steps.md#BKMK_ApplyDriverPackage) ステップを使用します。  

- タスク シーケンスの [[パッケージ コンテンツのダウンロード]](../understand/task-sequence-steps.md#BKMK_DownloadPackageContent) ステップ。 スタンドアロン メディアでは管理ポイントの情報は使用できません。そのため、コンテンツの場所を列挙しようとするこのステップは失敗します。  

- ソフトウェア更新プログラムのインストール  

- OS 展開前のソフトウェアのインストール  

- OS 以外の展開用のカスタム タスク シーケンス  

- ユーザーとデバイスのアフィニティをサポートする展開先のコンピューターとユーザーの関連付け  

- [パッケージのインストール](../understand/task-sequence-steps.md#BKMK_InstallPackage) ステップを使用した動的なパッケージのインストール  

- [アプリケーションのインストール](../understand/task-sequence-steps.md#BKMK_InstallApplication) ステップを使用した動的なアプリケーションのインストール

- **[Windows と ConfigMgr のセットアップ]** タスク シーケンス ステップの **[使用可能な場合は、実稼働前クライアント パッケージを使用する]** 設定。 この設定の詳細については、「[Windows と ConfigMgr のセットアップ](../understand/task-sequence-steps.md#BKMK_SetupWindowsandConfigMgr)」を参照してください。  

> [!NOTE]  
> タスク シーケンスに [[パッケージのインストール]](../understand/task-sequence-steps.md#BKMK_InstallPackage) ステップが含まれる場合に、中央管理サイトでスタンドアロン メディアを作成すると、エラーが発生する可能性があります。 中央管理サイトには、必要なクライアント構成ポリシーがありません。 これらのポリシーは、タスク シーケンスの実行時にソフトウェア配布エージェントを有効にするために必要になります。 **CreateTsMedia.log** ファイルに次のエラーが表示される場合があります。  
>
> `WMI method SMS_TaskSequencePackage.GetClientConfigPolicies failed (0x80041001)`
>
> **[パッケージのインストール]** ステップを含むスタンドアロン メディアの場合は、ソフトウェア配布エージェントが有効になっているプライマリ サイトでスタンドアロン メディアを作成します。
>
> または、カスタムの [[コマンド ラインの実行]](../understand/task-sequence-steps.md#BKMK_RunCommandLine) ステップを使用します。 [[Windows と ConfigMgr のセットアップ]](../understand/task-sequence-steps.md#BKMK_SetupWindowsandConfigMgr) ステップの後、最初の **[パッケージのインストール]** ステップの前に追加します。 **[コマンド ラインの実行]** ステップでは、最初の [パッケージのインストール] ステップの前に、以下の WMIC コマンドを実行してソフトウェア配布エージェントを有効にします。  
>
> `WMIC /namespace:\\\root\ccm\policy\machine\requestedconfig path ccm_SoftwareDistributionClientConfig CREATE ComponentName="Enable SWDist", Enabled="true", LockSettings="TRUE", PolicySource="local", PolicyVersion="1.0", SiteSettingsKey="1" /NOINTERACTIVE`

### <a name="distribute-all-content-associated-with-the-task-sequence"></a>タスク シーケンスに関連付けられているすべてのコンテンツを配布する

少なくとも 1 つの配布ポイントに対して、タスク シーケンスで必要なすべてのコンテンツを配布します。 このコンテンツには、ブート イメージ、OS イメージ、およびその他の関連するファイルが含まれます。 メディアの作成時に、ウィザードによって配布ポイントからコンテンツが収集されます。

ユーザー アカウントには、少なくとも配布ポイントのコンテンツ ライブラリへの**読み取り**アクセス権が必要です。 詳細については、「[コンテンツの配布](../../core/servers/deploy/configure/deploy-and-manage-content.md#bkmk_distribute)」をご覧ください。

### <a name="prepare-the-removable-usb-drive"></a>リムーバブル USB ドライブを準備する

リムーバブル USB ドライブを使用している場合は、タスク シーケンス メディアの作成ウィザードを実行するコンピューターにそれを接続します。 USB ドライブは、リムーバブル デバイスとして Windows で検出できる必要があります。 メディアの作成時に、ウィザードによって USB ドライブに直接書き込まれます。

スタンドアロン メディアでは FAT32 ファイル システムが使用されています。 スタンドアロン メディアは、サイズが 4 GB を超えるファイルがコンテンツとして含まれるリムーバブル USB ドライブには作成できません。

### <a name="create-an-output-folder"></a>出力フォルダーを作成する

タスク シーケンス メディアの作成ウィザードを実行して CD または DVD セット用のメディアを作成する前に、ウィザードで作成される出力ファイル用のフォルダーを作成します。 CD または DVD セット用に作成されるメディアは、そのフォルダーに .ISO ファイルとして直接書き込まれます。


## <a name="process"></a>プロセス

1. Configuration Manager コンソールで、 **[ソフトウェア ライブラリ]** ワークスペースに移動し、 **[オペレーティング システム]** を展開して **[タスク シーケンス]** ノードを選択します。  

2. リボンの **[ホーム]** タブにある **[作成]** グループで、 **[タスク シーケンス メディアの作成]** を選択します。 このアクションにより、タスク シーケンス メディアの作成ウィザードが起動します。  

3. **[メディアの種類の選択]** ページで次のオプションを指定します。  

    - **[スタンドアロン メディア]** を選択します。  

    - 必要に応じて、ユーザーの入力なしに OS を展開できるようにするには、 **[オペレーティング システムの無人展開を許可する]** を選択します。  

        > [!IMPORTANT]  
        > このオプションを選択すると、ネットワーク構成情報またはオプションのタスク シーケンスのプロンプトはユーザーに表示されません。 メディアにパスワード保護を構成した場合、ユーザーは引き続きパスワードの入力を求められます。  

4. **[メディアの種類]** ページで、メディアが **[リムーバブル USB ドライブ]** か **[CD/DVD セット]** のいずれであるかを指定します。 次のオプションを構成します。  

    > [!IMPORTANT]  
    > メディアでは FAT32 ファイル システムが使用されています。 メディアは、コンテンツにサイズが 4 GB を超えるファイルが入っている USB ドライブには作成できません。  

    - **[リムーバブル USB ドライブ]** を選択した場合は、コンテンツを格納するドライブを選択します。  

        - **[リムーバブル USB ドライブをフォーマットし (FAT32)、起動可能にする]** :既定では、Configuration Manager によって USB ドライブが準備されます。 多くの新しい UEFI デバイスには起動可能な FAT32 パーティションが必要です。 ただし、このフォーマットではファイルのサイズとドライブの全体的な容量も制限されます。 リムーバブル ドライブを既にフォーマットして構成している場合は、このオプションを無効にします。

    - **[CD/DVD セット]** を選択した場合は、メディアの容量 ( **[メディアのサイズ]** ) および出力ファイル ( **[メディア ファイル]** ) の名前とパスを指定します。 この場所に出力ファイルが書き込まれます。 例: `\\servername\folder\outputfile.iso`  

        メディアにコンテンツ全体を保存しきれない場合は、複数のファイルが作成されます。 その後、コンテンツを複数の CD または DVD に保存する必要があります。 複数のメディア ファイルが必要な場合は、Configuration Manager が作成する各出力ファイルの名前に連番が付けられます。  

        OS と共にアプリケーションを展開し、アプリケーションが 1 つのメディアに収まらない場合、Configuration Manager は複数のメディアでアプリケーションを保存します。 スタンドアロン メディアを実行している場合、Configuration Manager は、アプリケーションを保存する次のメディアの指定をユーザーに求めます。  

        > [!IMPORTANT]  
        > 既存の .iso イメージを選択した場合は、タスク シーケンス メディア ウィザードの次のページに進むと、ドライブまたは共有フォルダーからイメージが削除されます。 既存のイメージは、ウィザードをキャンセルしても削除されます。  

    - **ステージング フォルダー**<!--1359388-->:メディアの作成プロセスでは、一時ドライブに大きな空き領域が必要になる場合があります。 既定では、この場所は次のようなパスになります。`%UserProfile%\AppData\Local\Temp` これらの一時ファイルの格納場所をより柔軟に選択できるようにするため、バージョン 1902 以降では、この値を別のドライブおよびパスに変更します。  

    - **メディア ラベル**<!--1359388-->:バージョン 1902 以降では、ラベルをタスク シーケンス メディアに追加します。 このラベルは、作成したメディアを識別しやすくするのに役立ちます。 既定値は `Configuration Manager` です。 このテキスト フィールドは、次の場所に表示されます。  

        - ISO ファイルをマウントすると、Windows では、マウントされたドライブの名前としてこのラベルが表示されます  

        - USB ドライブをフォーマットする場合、ラベルの最初の 11 文字が名前として使用されます  

        - Configuration Manager では、`MediaLabel.txt` というテキスト ファイルがメディアのルートに書き込まれます。 既定では、このファイルには、`label=Configuration Manager` の 1 行テキストが含まれます。 メディアのラベルをカスタマイズする場合は、既定値の代わりにカスタム ラベルがこの行で使用されます。  

    - **メディアに autorun.inf ファイルを含める**<!-- 4090666 -->:バージョン 1906 以降では、Configuration Manager で autorun.inf ファイルが既定で追加されません。 通常、このファイルはマルウェア対策製品によってブロックされます。 Windows の自動実行機能の詳細については、「[Creating an AutoRun-enabled CD-ROM Application](https://docs.microsoft.com/windows/desktop/shell/autoplay)」 (自動実行が有効にされた CD-ROM アプリケーションを作成する) を参照してください。 引き続きシナリオに必要な場合は、このオプションを選択してファイルに含めます。  

5. **[セキュリティ]** ページで、次のオプションを指定します。

    - **[メディアをパスワードで保護する]** :承認されていないアクセスからメディアを保護するために強力なパスワードを入力します。 パスワードを指定すると、ユーザーはメディアを使用するためにパスワードを入力する必要があります。  

        > [!IMPORTANT]  
        > セキュリティのベスト プラクティスとして、メディアの保護に役立つパスワードを常に割り当てることをお勧めします。  
        >
        > スタンドアロン メディアでは、タスク シーケンス ステップとその変数のみが暗号化されます。 メディアの残りのコンテンツは暗号化されません。 タスク シーケンスのスクリプトには機密情報を含めないでください。 機密情報はすべて、タスク シーケンスの変数を使用して保存し、実装します。  

    - **このスタンドアロン メディアが有効な日付の範囲を選択する**: メディアに任意の開始日付/有効期限を設定します。 この設定は既定で無効になっています。 スタンドアロン メディアが実行される前に、この日付はコンピューター上のシステム時刻と比較されます。 システム時刻が開始時刻より前か、有効期限より後の場合、スタンドアロン メディアは開始されません。 これらのオプションは、[New-CMStandaloneMedia](https://docs.microsoft.com/powershell/module/configurationmanager/new-cmstandalonemedia?view=sccm-ps) PowerShell コマンドレットを使用して利用することもできます。  

6. **[スタンドアロン CD/DVD]** ページで、OS を展開するタスク シーケンスを選択します。 ブート イメージに関連付けられたタスク シーケンスのみを選択できます。 タスク シーケンスによって参照されるコンテンツの一覧を確認します。  

    - **関連付けられたアプリケーションの依存関係を検出し、このメディアに追加する**: また、アプリケーションの依存関係のメディアにコンテンツを追加します。  

        > [!TIP]  
        > 必要なアプリケーションの依存関係が表示されない場合は、このオプションを選択解除してから再度選択し、リストを更新します。  

7. **[アプリケーションの選択]** ページで、メディア ファイルの一部として含める追加のアプリケーション コンテンツを指定します。  

8. **[パッケージの選択]** ページで、メディア ファイルの一部として含める追加のパッケージ コンテンツを指定します。  

9. **[ドライバー パッケージの選択]** ページで、メディア ファイルの一部として含める追加のドライバー パッケージ コンテンツを指定します。  

10. **[配布ポイント]** ページで、必要なコンテンツを含む配布ポイントを指定します。  

    Configuration Manager には、コンテンツが含まれる配布ポイントのみが表示されます。 続行する前に、タスク シーケンスに関連付けられているすべてのコンテンツを少なくとも 1 つの配布ポイントに配布します。 コンテンツを配布した後、配布ポイントの一覧を更新します。 このページで既に選択している配布ポイントをすべて削除し、前のページに移動して **[配布ポイント]** ページに戻ります。 または、ウィザードを再起動します。 詳細については、「[タスク シーケンスによって参照されるコンテンツの配布](manage-task-sequences-to-automate-tasks.md#BKMK_DistributeTS)」と「[コンテンツとコンテンツ インフラストラクチャの管理](../../core/servers/deploy/configure/manage-content-and-content-infrastructure.md)」を参照してください。  

11. **[カスタマイズ]** ページで、次のオプションを指定します。  

    - タスク シーケンスで使用される変数を追加します。  

    - **起動前コマンドを有効にする**: タスク シーケンスを実行する前に実行する起動前コマンドを指定します。 起動前コマンドは、タスク シーケンスを実行する前に、Windows PE でユーザーと対話できるスクリプトまたは実行可能ファイルです。 詳細については、「[タスク シーケンス メディアの起動前コマンド](../understand/prestart-commands-for-task-sequence-media.md)」を参照してください。  

        > [!TIP]  
        > メディアの作成中に、タスク シーケンスによって、パッケージ ID と起動前コマンドライン (タスク シーケンスの変数の値を含む) が、Configuration Manager コンソールを実行しているコンピューターの **CreateTSMedia.log** というログファイルに書き込まれます。 このログ ファイルで、タスク シーケンスの変数の値を確認できます。  

        起動前コマンドで何らかのコンテンツが必要な場合は、 **[起動前コマンドにファイルを含める]** オプションを選択します。  

12. ウィザードを完了します。  

スタンドアロンのメディア ファイル (.ISO) は、対象フォルダーに作成されます。 **[CD/DVD セット]** を選択した場合は、出力ファイルを一連の CD または DVD にコピーします。


## <a name="next-steps"></a>次のステップ

[ネットワークではなくスタンドアロン メディアを使用した Windows の展開](use-stand-alone-media-to-deploy-windows-without-using-the-network.md)
