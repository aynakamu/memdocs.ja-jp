---
title: 起動可能なメディアの作成
titleSuffix: Configuration Manager
description: Configuration Manager で起動可能なメディアを使用して、新しいバージョンの Windows をインストールしたり、コンピューターを置き換たりしえます。
ms.date: 08/11/2020
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: how-to
ms.assetid: ead79e64-1b63-4d0d-8bd5-addff8919820
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: a3ec1476a9b5374eb91d147e2b22fd0f669d6251
ms.sourcegitcommit: 99084d70c032c4db109328a4ca100cd3f5759433
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/20/2020
ms.locfileid: "88698046"
---
# <a name="create-bootable-media"></a>起動可能なメディアの作成

*適用対象:Configuration Manager (Current Branch)*

Configuration Manager の起動可能なメディアには、ブート イメージ、オプションとして起動前コマンドとそれに関連付けられているファイル、および Configuration Manager ファイルが含まれています。 起動可能なメディアは、次の OS の展開シナリオに使用します。

- [新しいコンピューター (ベア メタル) に新しいバージョンの Windows をインストールする](install-new-windows-version-new-computer-bare-metal.md)

- [既存のコンピューターの置き換えと設定の転送](replace-an-existing-computer-and-transfer-settings.md)

## <a name="usage"></a>使用方法

起動可能なメディアを起動すると、次のプロセスが行われます。

1. 対象コンピューターが起動する

1. ネットワークに接続する

1. サイトから次のコンテンツを取得する

    - 指定したタスク シーケンス

    - OS イメージ

    - その他の必要なコンテンツ

タスク シーケンスはメディアにはないため、タスク シーケンスやコンテンツを変更しても、メディアを再作成する必要はありません。

起動可能なメディアのパッケージは暗号化されていません。 承認されていないユーザーからパッケージのコンテンツを守るため、適切なセキュリティ手段を講じてください。 たとえば、メディアにパスワードを追加します。

バージョン 2006 以降では、起動可能なメディアによってクラウドベースのコンテンツをダウンロードできます。 デバイスには、管理ポイントへのイントラネット接続が引き続き必要になります。 これによりコンテンツが有効なクラウド管理ゲートウェイ (CMG) またはクラウド配布ポイントからコンテンツを取得できます。<!--6209223--> 詳細については、「[クラウドベースのコンテンツのサポート](use-bootable-media-to-deploy-windows-over-the-network.md#support-for-cloud-based-content)」を参照してください。

## <a name="prerequisites"></a>前提条件

タスク シーケンス メディアの作成ウィザードを使用して、起動可能なメディアを作成する前に、これらの条件がすべて満たされていることを確認してください。

### <a name="boot-image"></a>ブート イメージ

OS を展開するためにタスク シーケンスで使用するブート イメージについて、次の点を考慮してください。

- ブート イメージのアーキテクチャが、展開先のコンピューターのアーキテクチャに対して適切である必要があります。 たとえば、x64 のコンピューターでは、x86 または x64 のブート イメージを起動して実行できます。 ただし、x86 のコンピューターで起動して実行できるのは、x86 ブート イメージのみです。
- ブート イメージに、対象コンピューターのプロビジョニングに必要なネットワーク ドライバーと記憶装置ドライバーが含まれている必要があります。

### <a name="create-a-task-sequence-to-deploy-an-os"></a>OS を展開するためのタスク シーケンスの作成

起動可能なメディアの一部として、OS を展開するタスク シーケンスを指定します。 詳しくは、[OS をインストールするタスク シーケンスの作成](create-a-task-sequence-to-install-an-operating-system.md)に関するページをご覧ください。

### <a name="distribute-all-content-associated-with-the-task-sequence"></a>タスク シーケンスに関連付けられているすべてのコンテンツを配布する

少なくとも 1 つの配布ポイントに対して、タスク シーケンスで必要なすべてのコンテンツを配布します。 このコンテンツには、ブート イメージと、その他の関連する起動前ファイルが含まれます。 起動可能なメディアの作成時に、ウィザードによって配布ポイントからコンテンツが収集されます。

ユーザー アカウントには、少なくとも配布ポイントのコンテンツ ライブラリへの**読み取り**アクセス権が必要です。 詳細については、「[コンテンツの配布](../../core/servers/deploy/configure/deploy-and-manage-content.md#bkmk_distribute)」をご覧ください。

### <a name="prepare-the-removable-usb-drive"></a>リムーバブル USB ドライブを準備する

リムーバブル USB ドライブを使用している場合は、タスク シーケンス メディアの作成ウィザードを実行するコンピューターにそれを接続します。 USB ドライブは、リムーバブル デバイスとして Windows で検出できる必要があります。 メディアの作成時に、ウィザードによって USB ドライブに直接書き込まれます。

### <a name="create-an-output-folder"></a>出力フォルダーを作成する

タスク シーケンス メディアの作成ウィザードを実行して CD または DVD セット用のメディアを作成する前に、ウィザードで作成される出力ファイル用のフォルダーを作成します。 CD または DVD セット用に作成されるメディアは、そのフォルダーに .ISO ファイルとして直接書き込まれます。

## <a name="process"></a>プロセス

> [!NOTE]
> PKI 環境では、ルート証明機関 (CA) をプライマリ サイトで指定するため、起動可能なメディアはプライマリ サイトで必ず作成してください。 中央管理サイト (CAS) には、起動可能なメディアを適切に作成するためのルート CA 情報はありません。

1. Configuration Manager コンソールで、 **[ソフトウェア ライブラリ]** ワークスペースに移動し、 **[オペレーティング システム]** を展開して **[タスク シーケンス]** ノードを選択します。

1. リボンの **[ホーム]** タブにある **[作成]** グループで、**[タスク シーケンス メディアの作成]** を選択します。 このアクションにより、タスク シーケンス メディアの作成ウィザードが起動します。

1. **[メディアの種類の選択]** ページで次のオプションを指定します。

    - [起動可能なメディア]**** を選択します。

    - 必要に応じて、ユーザーの入力なしに OS を展開できるようにするには、**[オペレーティング システムの無人展開を許可する]** を選択します。

        > [!IMPORTANT]
        > このオプションを選択すると、ネットワーク構成情報またはオプションのタスク シーケンスのプロンプトはユーザーに表示されません。 メディアにパスワード保護を構成した場合、ユーザーは引き続きパスワードの入力を求められます。

1. **[メディア管理]** ページで次のオプションのいずれかを指定します。

    - **[動的メディア]**: サイト境界内のクライアントの場所に基づいて、ある管理ポイントから別の管理ポイントにメディアをリダイレクトできるようにします。

    - **[サイトベースのメディア]**: メディアを指定した管理ポイントにのみ接続します。

1. **[メディアの種類]** ページで、メディアが **[リムーバブル USB ドライブ]** か **[CD/DVD セット]** のいずれであるかを指定します。 次のオプションを構成します。

    > [!IMPORTANT]
    > メディアでは FAT32 ファイル システムが使用されています。 メディアは、コンテンツにサイズが 4 GB を超えるファイルが入っている USB ドライブには作成できません。

    - **[リムーバブル USB ドライブ]** を選択した場合は、コンテンツを格納するドライブを選択します。

        - **リムーバブル USB ドライブをフォーマットし (FAT32)、起動可能にする**: 既定では、Configuration Manager で USB ドライブを準備することができます。 多くの新しい UEFI デバイスには起動可能な FAT32 パーティションが必要です。 ただし、このフォーマットではファイルのサイズとドライブの全体的な容量も制限されます。 リムーバブル ドライブを既にフォーマットして構成している場合は、このオプションを無効にします。

    - **[CD/DVD セット]** を選択した場合は、メディアの容量 (**[メディアのサイズ]**) および出力ファイル (**[メディア ファイル]**) の名前とパスを指定します。 この場所に出力ファイルが書き込まれます。 例: `\\servername\folder\outputfile.iso`

        メディアにコンテンツ全体を保存しきれない場合は、複数のファイルが作成されます。 その後、コンテンツを複数の CD または DVD に保存する必要があります。 複数のメディア ファイルが必要な場合は、Configuration Manager が作成する各出力ファイルの名前に連番が付けられます。

        > [!IMPORTANT]
        > 既存の .iso イメージを選択した場合は、タスク シーケンス メディア ウィザードの次のページに進むと、ドライブまたは共有フォルダーからイメージが削除されます。 既存のイメージは、ウィザードをキャンセルしても削除されます。

    - **ステージング フォルダー**<!--1359388-->:メディアの作成プロセスでは、一時ドライブに空き領域がたくさん必要になる場合があります。 既定では、この場所は次のようなパスになります。`%UserProfile%\AppData\Local\Temp` これらの一時ファイルの格納場所をより柔軟に選択できるようにするため、この値を別のドライブおよびパスに変更できます。

    - **メディア ラベル**<!--1359388-->:タスク シーケンス メディアにラベルを追加します。 このラベルは、作成したメディアを識別しやすくするのに役立ちます。 既定値は `Configuration Manager` です。 このテキスト フィールドは、次の場所に表示されます。

        - ISO ファイルをマウントすると、Windows では、マウントされたドライブの名前としてこのラベルが表示されます。

        - USB ドライブをフォーマットする場合、ラベルの最初の 11 文字が名前として使用されます。

        - Configuration Manager では、`MediaLabel.txt` というテキスト ファイルがメディアのルートに書き込まれます。 既定では、このファイルには、`label=Configuration Manager` の 1 行テキストが含まれます。 メディアのラベルをカスタマイズする場合は、既定値の代わりにカスタム ラベルがこの行で使用されます。

    - **メディアに autorun.inf ファイルを含める**<!-- 4090666 -->: バージョン 1906 以降では、Configuration Manager で autorun.inf ファイルが既定で追加されません。 通常、このファイルはマルウェア対策製品によってブロックされます。 Windows の自動実行機能の詳細については、「[Creating an AutoRun-enabled CD-ROM Application](/windows/desktop/shell/autoplay)」 (自動実行が有効にされた CD-ROM アプリケーションを作成する) を参照してください。 引き続きシナリオに必要な場合は、このオプションを選択してファイルに含めます。

1. **[セキュリティ]** ページで、次のオプションを指定します。

    - **[不明なコンピューターのサポートを有効にする]**: メディアが Configuration Manager で管理されていないコンピューターに OS を展開できるようにします。 これらのコンピューターのレコードは Configuration Manager データベースには存在しません。 詳細については、「[不明なコンピューターの展開の準備](../get-started/prepare-for-unknown-computer-deployments.md)」を参照してください。

    - **[パスワードでメディアを保護する]**: 承認されていないアクセスからメディアを保護するために強力なパスワードを入力します。 パスワードを指定すると、ユーザーは起動可能なメディアを使用するためにパスワードを入力する必要があります。

        > [!IMPORTANT]
        > セキュリティのベスト プラクティスとして、起動可能なメディアの保護に役立つパスワードを常に割り当てることをお勧めします。

    - HTTP 通信の場合は、**[自己署名入りメディア証明書を作成する]** を選択します。 次に、証明書の開始日と終了日を指定します。

        > [!NOTE]
        > このオプションを選択した場合、このウィザードの **[ブート イメージ]** ページで [HTTPS 管理ポイント] を選択できなくなります。

    - HTTPS 通信の場合は、**[PKI 証明書のインポート]** を選択します。 次に、インポートする証明書とそのパスワードを指定します。

        ブート イメージで使用される、このクライアント証明書の詳細については、[PKI 証明書の要件](../../core/plan-design/network/pki-certificate-requirements.md)に関するページを参照してください。

    - **[ユーザーとデバイスのアフィニティ]**: Configuration Manager でユーザー中心の管理をサポートするため、ユーザーと対象コンピューターをメディアによって関連付ける方法を指定します。 OS の展開でユーザーとデバイスのアフィニティをサポートする方法については、[展開先のコンピューターにユーザーを関連付ける](../get-started/associate-users-with-a-destination-computer.md)方法に関するページをご覧ください。

        - **[ユーザーとデバイスのアフィニティを自動的に承認する]**: メディアによってユーザーと対象コンピューターが自動的に関連付けられます。 この機能は、OS を展開するタスク シーケンスのアクションに基づきます。 このシナリオでは、タスク シーケンスで展開先のコンピューターに OS が展開されるときに、指定のユーザーと展開先のコンピューターのリレーションシップが作成されます。

        - **[ユーザーとデバイスのアフィニティを管理者の承認待ちにする]**: 承認後にユーザーと展開先のコンピューターがメディアによって関連付けられます。 この機能は、OS を展開するタスク シーケンスのスコープに基づきます。 このシナリオでは、タスク シーケンスによって、指定のユーザーと対象のコンピューターの間に関係が作成されます。 次に、管理ユーザーからの承認を待ち、承認後、OS が展開されます。

        - **[ユーザーとデバイスのアフィニティを使用しない]**: ユーザーと展開先のコンピューターがメディアによって関連付けられません。 このシナリオでは、タスク シーケンスでは OS の展開時にユーザーが展開先のコンピューターに関連付けられません。

1. **[ブート イメージ]** ページで、次のオプションを指定します。

    > [!IMPORTANT]
    > 配布するブート イメージのアーキテクチャが、配布先のコンピューターのアーキテクチャに適している必要があります。 たとえば、x64 のコンピューターでは、x86 または x64 のブート イメージを起動して実行できます。 ただし、x86 のターゲット コンピューターで起動して実行できるのは、x86 ブート イメージのみです。

    - **[ブート イメージ]**: ターゲット コンピューターを起動するブート イメージを選択します。

    - **[配布ポイント]**: ブート イメージがある配布ポイントを選択します。 配布ポイントからブート イメージが取得されてメディアに書き込まれます。

        > [!NOTE]
        > ユーザー アカウントには、少なくとも配布ポイントのコンテンツ ライブラリへの**読み取り**アクセス権が必要です。

    - **[管理ポイント]**: *サイトベースのメディア*に対してのみ、プライマリ サイトから管理ポイントを選択します。

    - **[関連付けられている管理ポイント]**: *[動的メディア]* に対してのみ、使用するプライマリ サイトの管理ポイントと、初期通信での優先順位を選択します。

        > [!NOTE]
        > このウィザードの **[セキュリティ]** ページで PKI 証明書を指定すると、このページには、HTTPS が有効な管理ポイントのみが表示されます。

1. **[カスタマイズ]** ページで、次のオプションを指定します。

    - タスク シーケンスで使用される変数を追加します。

    - **[起動前コマンドを有効にする]**: タスク シーケンスを実行する前に、実行する起動前コマンドを指定します。 起動前コマンドは、タスク シーケンスを実行する前に、Windows PE でユーザーと対話できるスクリプトまたは実行可能ファイルです。 詳細については、「[タスク シーケンス メディアの起動前コマンド](../understand/prestart-commands-for-task-sequence-media.md)」を参照してください。

        > [!TIP]
        > メディアの作成中に、タスク シーケンスによって、パッケージ ID と起動前コマンドライン (タスク シーケンスの変数の値を含む) が、Configuration Manager コンソールを実行しているコンピューターの **CreateTSMedia.log** というログファイルに書き込まれます。 このログ ファイルで、タスク シーケンスの変数の値を確認できます。

        起動前コマンドで何らかのコンテンツが必要な場合は、**[起動前コマンドにファイルを含める]** オプションを選択します。

1. ウィザードを完了します。

## <a name="alternate-method"></a>別の方法

リムーバブル USB ドライブが Configuration Manager コンソールを実行しているコンピューターに接続されていない場合は、ドライブに起動可能なメディアを作成できます。

1. [タスク シーケンス起動メディアを作成します](#process)。 **[メディアの種類]** ページで、**[CD/DVD セット]** を選択します。 ウィザードで指定した場所に出力ファイルが書き込まれます。 (例: `\\servername\folder\outputfile.iso`)。  

1. リムーバブル USB ドライブを準備します。 ドライブは書式設定され、空であり、かつ、起動可能である必要があります。

1. 共有の場所から ISO をマウントし、ISO イメージから USB ドライブにファイルを転送します。

## <a name="next-steps"></a>次のステップ

[起動可能なメディアを使用したネットワーク経由での Windows の展開](use-bootable-media-to-deploy-windows-over-the-network.md)