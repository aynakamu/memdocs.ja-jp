---
title: ユーザーとデバイスのアフィニティへのユーザーとデバイスの関連付け
titleSuffix: Configuration Manager
description: ユーザーとデバイスのアフィニティにユーザーとデバイスを関連付けて、ユーザーに関連付けられたすべてのデバイスにアプリを自動的に展開します。
ms.date: 07/26/2019
ms.prod: configuration-manager
ms.technology: configmgr-app
ms.topic: conceptual
ms.assetid: 5b30b0d5-722d-4d4b-9ed7-5a43de315461
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 8e1a55efa6b23aa489ea65b3296e33847163a5c4
ms.sourcegitcommit: 99084d70c032c4db109328a4ca100cd3f5759433
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/20/2020
ms.locfileid: "88695241"
---
# <a name="link-users-and-devices-with-user-device-affinity-in-configuration-manager"></a>Configuration Manager でのユーザーとデバイスのアフィニティへのユーザーとデバイスの関連付け

*適用対象:Configuration Manager (Current Branch)*

Configuration Manager のユーザーとデバイスのアフィニティにより、1 人のユーザーが 1 台以上のデバイスに関連付けられます。 この動作により、ユーザーのデバイス名を把握しなくても、アプリケーションをユーザーに展開することができます。 この場合、アプリケーションを各ユーザーのデバイスに展開するのではなく、アプリケーションをユーザーに展開します。 ユーザーとデバイスのアフィニティによって、そのユーザーに関連付けられているすべてのデバイスにアプリケーションが自動的にインストールされます。  

ユーザーが毎日作業に使用するプライマリ デバイスを定義します。 ユーザーとデバイスの間にアフィニティを作成すると、アプリの展開の選択肢が増えます。 たとえば、ユーザーが Microsoft Visio を必要とする場合は、Windows インストーラーの展開を使用して、Microsoft Visio をユーザーのプライマリ デバイスにインストールすることができます。 ただし、プライマリ デバイスでないデバイスには、Visio を仮想アプリケーションとして展開してもかまいません。 また、ユーザーとデバイスのアフィニティを使用して、ユーザーがログオンしていないときにソフトウェアをユーザーのデバイスに事前に展開することもできます。 次にユーザーがログインすると、アプリはインストール済みで実行できる状態になります。  

コンピューターのユーザーとデバイスのアフィニティ情報のみを管理します。 Configuration Manager では、登録されているモバイル デバイスのユーザーとデバイスのアフィニティが自動的に管理されます。  

## <a name="manually-set-up-user-device-affinity"></a>ユーザーとデバイスのアフィニティの手動セットアップ  

1. Configuration Manager コンソールで、 **[資産とコンプライアンス]** ワークスペースに移動して、 **[デバイス]** ノードを選択します。  

1. デバイスを選択します。 リボンの **[ホーム]** タブの **[デバイス]** グループで、 **[プライマリ ユーザーの編集]** を選びます。  

1. **[プライマリ ユーザーの編集]** ダイアログ ボックスで、選択したデバイスのプライマリ ユーザーとして追加するユーザーを検索して選びます。 **[追加]** を選びます。  

    > [!NOTE]  
    > **[プライマリ ユーザー]** リストに、このデバイスのプライマリ ユーザーであるユーザーと、ユーザー デバイス関係の割り当て方法が表示されます。  

## <a name="set-up-primary-devices-for-a-user"></a>ユーザーのプライマリ デバイスをセットアップする  

1. Configuration Manager コンソールで、 **[資産とコンプライアンス]** ワークスペースに移動して、 **[ユーザー]** ノードを選択します。  

1. ユーザーを選択します。 リボンの **[デバイス]** タブの **[プライマリ デバイスの編集]** を選びます。  

1. **[プライマリ デバイスの編集]** ダイアログ ボックスで、選択したユーザーにプライマリ デバイスとして追加するデバイスを検索して選びます。 **[追加]** を選びます。  

    > [!NOTE]  
    > **[プライマリ ユーザー]** リストに、このユーザーのプライマリ デバイスとしてセットアップされているデバイスと、各ユーザー デバイス関係の割り当て方法が表示されます。  

## <a name="automatically-create-user-device-affinities-windows-pcs-only"></a>ユーザーとデバイスのアフィニティの自動作成 (Windows PC のみ)

Configuration Manager によって、Windows イベント ログからユーザーのログオン イベントに関するデータが読み取られます。 ユーザーとデバイスのアフィニティを自動的に作成するには、クライアント コンピューターのローカル セキュリティ ポリシーで次の 2 つのオプションを有効にして、ログオン イベントを Windows イベント ログに保存します。  

- **アカウント ログオン イベントの監査**  
- **ログオン イベントの監査**  

これらの設定を構成するには、Windows グループ ポリシーを使います。  

> [!IMPORTANT]  
> エラーによって Windows イベント ログに多数のエントリが生成されると、新しいイベント ログが作成される可能性があります。 この動作が発生すると、Configuration Manager で既存のログオン イベントが使用できなくなる場合があります。  

### <a name="set-up-the-site-to-automatically-create-user-device-affinities"></a>ユーザーとデバイスのアフィニティを自動作成するためにサイトをセットアップする  

1. Configuration Manager コンソールで、 **[管理]** ワークスペースに移動して、 **[クライアント設定]** ノードを選択します。  

1. 既定のクライアント設定を変更するには、 **[既定のクライアント設定]** を選択します。 リボンの **[ホーム]** タブの **[プロパティ]** グループで、 **[プロパティ]** を選択します。

    カスタムのクライアント エージェント設定を作成するには、リボンの **[ホーム]** タブの **[作成]** グループで、 **[カスタム クライアント デバイス設定の作成]** を選択します。

    > [!NOTE]  
    > 既定のクライアント設定を変更すると、サイトによって階層内のすべてのコンピューターにそれが展開されます。 詳しくは、「[クライアント設定を構成する方法](../../core/clients/deploy/configure-client-settings.md)」をご覧ください。  

1. **[ユーザーとデバイスのアフィニティ]** グループで、次のように設定します。  

    - **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (分)]** :サイトがユーザーとデバイスのアフィニティを作成するまでのデバイス使用分数を設定します。  

    - **ユーザーとデバイスのアフィニティ使用状況のしきい値 (日)** :サイトで使用状況に基づいたアフィニティのしきい値を測定する日数を設定します。  

    - **使用状況データに基づいてユーザーとデバイスのアフィニティを自動構成する**:サイトでユーザーとデバイスのアフィニティを自動作成するには、 **[True]** を選択します。 **[False]** を選択した場合は、すべてのユーザーとデバイスのアフィニティ割り当てを手動で承認する必要があります。  

    > [!TIP]  
    > たとえば、 **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (分)]** を **60** 分に設定し、 **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (日)]** を **5** 日に設定している場合、ユーザーとデバイスのアフィニティを自動的に作成するには、ユーザーは 5 日間に 60 分以上デバイスを使用する必要があります。  

Configuration Manager では、ユーザーとユーザーとデバイスのアフィニティが自動的に作成された後、ユーザーとデバイスのアフィニティのしきい値が引き続き監視されます。 デバイスに対するユーザーのアクティビティが設定したしきい値を下回ると、サイトによってユーザーとデバイスのアフィニティが削除されます。 **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (日)]** を、7 日以上の値に設定します。 この構成は、ユーザーがサインインしていないときに、週末などに自動的に構成されたユーザーとデバイスのアフィニティが失われる状況を回避します。  


## <a name="import-user-device-affinities-from-a-file"></a>ファイルからのユーザーとデバイスのアフィニティのインポート

一度に多くの関係を作成するには、複数のユーザーとデバイスのアフィニティの詳細を含むファイルをインポートします。 ターゲット デバイスがサイトによって既に検出されており、Configuration Manager データベースにリソースとして存在していることを確認します。  

1. Configuration Manager コンソールで、 **[資産とコンプライアンス]** ワークスペースに移動して、 **[ユーザー]** または **[デバイス]** のいずれかのノードを選択します。  

1. リボンの **[ホーム]** タブの **[作成]** グループで **[ユーザーとデバイスのアフィニティのインポート]** を選びます。  

1. ユーザーとデバイスのアフィニティのインポート ウィザードの **[マッピングの選択]** ページで、次の情報を設定します。  

    - **[ファイル名]** :  間にアフィニティを作成するユーザーとデバイスの一覧を含むコンマ区切り (CSV) ファイルを指定します。 このファイルでは、ユーザーとデバイスの各ペアはコンマで区切られ、それぞれのペアが別々の行になければなりません。 この形式を使用します: `<domain>\<username>,<device NetBIOS name>`  

    - **[このファイルに参考用の列見出しを付ける]** :  .csv ファイルに先頭行ヘッダーがある場合は、このオプションを選択します。 サイトでは、インポート中にヘッダー行が無視されます。  

1. 1 行に 3 項目以上が含まれているファイルをインポートする場合は、 **[列]** と **[割り当て]** を使用して、ユーザーとデバイスを表す列とインポート中に無視する列を指定します。  

1. ウィザードを完了します。  


## <a name="let-users-create-their-own-device-affinities"></a>ユーザーが自分とデバイスのアフィニティを作成できるようにする

ユーザーがソフトウェア センターで自分のユーザーとデバイスのアフィニティを作成するように設定します。

### <a name="set-up-the-site-to-allow-user-created-user-device-affinity-requests"></a>ユーザーが作成したユーザーとデバイスのアフィニティ要求を許可するようにサイトをセットアップする  

1  Configuration Manager コンソールで、 **[管理]** ワークスペースに移動して、 **[クライアント設定]** ノードを選択します。  

1. 既定のクライアント設定を変更するには、 **[既定のクライアント設定]** を選択します。 リボンの **[ホーム]** タブの **[プロパティ]** グループで、 **[プロパティ]** を選択します。

    カスタムのクライアント エージェント設定を作成するには、リボンの **[ホーム]** タブの **[作成]** グループで、 **[カスタム クライアント ユーザー設定の作成]** を選択します。

    > [!NOTE]  
    > 既定のクライアント設定を変更すると、サイトによって階層内のすべてのコンピューターにそれが展開されます。 詳しくは、[クライアント設定の構成](../../core/clients/deploy/configure-client-settings.md)に関するページをご覧ください。  

1. **[ユーザーとデバイスのアフィニティ]** グループで、 **[ユーザーがプライマリ デバイスを定義できるようにする]** の設定を有効にします。  

### <a name="set-up-a-user-device-affinity-in-software-center"></a>ソフトウェア センターでユーザーとデバイスのアフィニティを設定する

バージョン 1902 以降では、ソフトウェア センターを使用してアフィニティを設定します。

1. ソフトウェアセンターで、 **[オプション]** タブに移動します。

1. **[勤務時間の情報]** セクションで、 **[このコンピューターを日常の仕事で使用します]** オプションを選びます。

### <a name="set-up-a-user-device-affinity-in-the-application-catalog"></a>アプリケーション カタログでユーザーとデバイスのアフィニティを設定する

> [!Important]
> アプリケーション カタログの Silverlight ユーザー エクスペリエンスは、Current Branch バージョン 1806 以降では、サポートされません。 バージョン 1906 以降では、更新されたクライアントで、ユーザーが利用できるアプリケーション展開の管理ポイントが自動的に使用されます。 また、新しいアプリケーション カタログの役割はインストールできません。 アプリケーション カタログの役割のサポートは、バージョン 1910 で終了します。  
>
> 詳細については、以下の記事を参照してください。
>
> - [ソフトウェア センターの構成](../plan-design/plan-for-software-center.md#bkmk_userex)
> - [削除された機能と非推奨の機能](../../core/plan-design/changes/deprecated/removed-and-deprecated-cmfeatures.md)  

1. [アプリケーション カタログ] で **[マイ システム]** を選びます。  

1. **[このコンピューターを日常の仕事で使用します]** オプションを選びます。  


## <a name="manage-user-device-affinity-requests-from-users"></a>ユーザーからのユーザーとデバイスのアフィニティ要求の管理

クライアント設定を無効化して **[使用状況データに基づいてユーザーとデバイスのアフィニティを自動構成する]** 場合は、すべてのユーザーとデバイスのアフィニティ割り当てを手動で承認する必要があります。  

### <a name="approve-or-reject-a-user-device-affinity-request"></a>ユーザーとデバイスのアフィニティ要求を承認または拒否する  

1. Configuration Manager コンソールで、 **[資産とコンプライアンス]** ワークスペースに移動します。  

1. アフィニティ要求を管理するユーザーまたはデバイスのコレクションを選択します。  

1. リボンの **[ホーム]** タブの **[コレクション]** グループで、 **[アフィニティ要求の管理]** を選びます。  

1. **[ユーザーとデバイスのアフィニティ要求の管理]** ダイアログ ボックスで、アフィニティ要求を選択し、 **[承認]** または **[拒否]** を選びます。  


## <a name="next-steps"></a>次のステップ

また、Microsoft Intune を使用して、登録されたデバイスの主な用途を見つけることもできます。 詳細については、Intune ドキュメントの「[Intune デバイスのプライマリ ユーザーを確認する](/intune/find-primary-user)」を参照してください。